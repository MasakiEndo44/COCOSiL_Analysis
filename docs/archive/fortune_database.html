<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å ã„å¸«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼šè¨ºæ–­ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 28px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .controls {
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }
        
        .tab-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .tab-btn {
            padding: 10px 20px;
            border: none;
            background: #6c757d;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .tab-btn:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }
        
        .tab-btn.active {
            background: #667eea;
        }
        
        .export-controls {
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-primary:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
        }
        
        .content {
            padding: 20px;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .table-container {
            overflow-x: auto;
            margin: 20px 0;
            border: 1px solid #dee2e6;
            border-radius: 8px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }
        
        th, td {
            padding: 12px 8px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
            white-space: nowrap;
        }
        
        th {
            background: #667eea;
            color: white;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        tr:hover {
            background: #e3f2fd;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .stats-card {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .stats-title {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 15px;
            font-size: 16px;
        }
        
        .stats-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding: 5px 0;
            border-bottom: 1px solid #f1f3f4;
        }
        
        .master-section {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #dee2e6;
        }
        
        .master-title {
            color: #667eea;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 5px;
        }
        
        .info-text {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .highlight {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        
        .auto-field {
            background-color: #f8f9fa !important;
            color: #6c757d;
            font-style: italic;
            cursor: not-allowed;
        }
        
        .tag {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 2px 8px;
            margin: 2px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: bold;
        }
        
        .tag-input-container {
            position: relative;
        }
        
        .tag-input {
            width: 100%;
            border: none;
            background: transparent;
            padding: 5px;
            font-size: 14px;
            outline: none;
        }
        
        .tag-help {
            font-size: 10px;
            color: #6c757d;
            margin-top: 2px;
        }
        
        .editable {
            cursor: pointer;
            transition: background-color 0.2s;
            position: relative;
        }
        
        .editable:hover {
            background-color: #fff3cd !important;
            border: 1px solid #ffeaa7;
        }
        
        .editable.editing {
            background-color: #e3f2fd !important;
            border: 2px solid #667eea;
        }
        
        .edit-input {
            width: 100%;
            border: none;
            background: transparent;
            padding: 5px;
            font-size: 14px;
            outline: none;
        }
        
        .edit-indicator {
            position: absolute;
            top: 2px;
            right: 2px;
            color: #667eea;
            font-size: 10px;
        }
            .container {
                margin: 10px;
                border-radius: 10px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 22px;
            }
            
            .export-controls {
                justify-content: center;
            }
            
            .tab-container {
                justify-content: center;
            }
            
            table {
                font-size: 12px;
            }
            
            th, td {
                padding: 8px 4px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ”® å ã„å¸«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼šè¨ºæ–­ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </h1>
            <p>ãƒªãƒªãƒ¼ã‚¹å‰ãƒ†ã‚¹ãƒˆæ®µéš - è¨ºæ–­ã‚±ãƒ¼ã‚¹è“„ç©ãƒ»åˆ†æç”¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</p>
        </div>
        
        <div class="controls">
            <div class="tab-container">
                <button class="tab-btn active" onclick="showTab('records')">ğŸ“‹ è¨ºæ–­è¨˜éŒ²</button>
                <button class="tab-btn" onclick="showTab('stats')">ğŸ“Š çµ±è¨ˆåˆ†æ</button>
                <button class="tab-btn" onclick="showTab('master')">ğŸ“š å…¨ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿</button>
                <button class="tab-btn" onclick="showTab('settings')">âš™ï¸ è¨­å®š</button>
            </div>
            
            <div class="export-controls">
                <button class="btn btn-primary" onclick="exportToExcel()">ğŸ“¥ Excelå½¢å¼ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</button>
                <button class="btn btn-success" onclick="addNewRecord()">â• æ–°è¦è¨ºæ–­è¨˜éŒ²è¿½åŠ </button>
                <span class="highlight">ç·è¨˜éŒ²æ•°: <span id="recordCount">10</span>ä»¶</span>
            </div>
        </div>
        
        <div class="content">
            <!-- è¨ºæ–­è¨˜éŒ²ã‚¿ãƒ– -->
            <div id="records" class="tab-content active">
                <div class="info-text">
                    <strong>ğŸ“‹ è¨ºæ–­è¨˜éŒ²ç®¡ç†</strong><br>
                    å„è¨ºæ–­ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®è©³ç´°æƒ…å ±ã‚’è¨˜éŒ²ãƒ»ç®¡ç†ã—ã¾ã™ã€‚Claude AI ãŒèª­ã¿å–ã‚Šã‚„ã™ã„å½¢å¼ã§æ§‹é€ åŒ–ã•ã‚Œã¦ã„ã¾ã™ã€‚
                </div>
                
                <div class="highlight">
                    <strong>âœ¨ ç·¨é›†æ–¹æ³•ï¼š</strong>
                    å„ã‚»ãƒ«ï¼ˆé …ç›®ï¼‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ç·¨é›†å¯èƒ½ã«ãªã‚Šã¾ã™ã€‚
                    <strong>Enter</strong>ã§ä¿å­˜ã€<strong>Esc</strong>ã§ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã€‚
                    æ€§åˆ¥ãƒ»æ˜Ÿåº§ãƒ»å‹•ç‰©ãƒ»MBTIãƒ»ä½“ç™–ãƒ»æº€è¶³åº¦ã¯è‡ªå‹•ã§ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚
                    <strong>ğŸ¯ å¿—å‘ã¯å‹•ç‰©å ã„ã‹ã‚‰è‡ªå‹•æ±ºå®š</strong>ãƒ»<strong>ğŸ·ï¸ ç›¸è«‡ãƒ†ãƒ¼ãƒã¯ã‚¿ã‚°å½¢å¼ï¼ˆã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šï¼‰</strong>
                </div>
                
                <div class="table-container">
                    <table id="recordsTable">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>è¨ºæ–­æ—¥æ™‚</th>
                                <th>ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå</th>
                                <th>ç”Ÿå¹´æœˆæ—¥</th>
                                <th>å¹´é½¢</th>
                                <th>æ€§åˆ¥</th>
                                <th>æ˜Ÿåº§</th>
                                <th>å‹•ç‰©å ã„</th>
                                <th>å¿—å‘</th>
                                <th>è‰²</th>
                                <th>MBTI</th>
                                <th>ä¸»ä½“ç™–</th>
                                <th>å‰¯ä½“ç™–</th>
                                <th>6æ˜Ÿå è¡“</th>
                                <th>ç›¸è«‡ãƒ†ãƒ¼ãƒ</th>
                                <th>æä¾›ã‚¢ãƒ‰ãƒã‚¤ã‚¹</th>
                                <th>æº€è¶³åº¦</th>
                                <th>æ‰€è¦æ™‚é–“</th>
                                <th>æ„Ÿæƒ³</th>
                                <th>ä½œæˆãƒ¬ãƒãƒ¼ãƒˆURL</th>
                                <th>ã‚¤ãƒ³ã‚¿ãƒ“ãƒ¥ãƒ¼äºˆå®š</th>
                                <th>ã‚¤ãƒ³ã‚¿ãƒ“ãƒ¥ãƒ¼å®Ÿæ–½</th>
                                <th>å‚™è€ƒ</th>
                            </tr>
                        </thead>
                        <tbody id="recordsBody">
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- çµ±è¨ˆåˆ†æã‚¿ãƒ– -->
            <div id="stats" class="tab-content">
                <div class="info-text">
                    <strong>ğŸ“Š çµ±è¨ˆåˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</strong><br>
                    è¨ºæ–­ãƒ‡ãƒ¼ã‚¿ã®å‚¾å‘åˆ†æã¨ãƒ‘ã‚¿ãƒ¼ãƒ³ç™ºè¦‹ã®ãŸã‚ã®é›†è¨ˆæƒ…å ±ã§ã™ã€‚
                </div>
                
                <div class="stats-grid" id="statsGrid">
                </div>
            </div>
            
            <!-- ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚¿ãƒ– -->
            <div id="master" class="tab-content">
                <div class="info-text">
                    <strong>ğŸ“š ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿</strong><br>
                    å ã„è¨ºæ–­ã§ä½¿ç”¨ã™ã‚‹åŸºæº–ãƒ‡ãƒ¼ã‚¿ã¨å‚ç…§æƒ…å ±ã§ã™ã€‚Claude AI ã®åˆ†æç²¾åº¦å‘ä¸Šã«æ´»ç”¨ã•ã‚Œã¾ã™ã€‚
                    æ˜Ÿåº§ãƒ»MBTIãƒ»6æ˜Ÿå è¡“ãƒ»å‹•ç‰©å ã„ãƒ»ä½“ç™–ã®å…¨å‚ç…§ãƒ‡ãƒ¼ã‚¿ã‚’å«ã¿ã¾ã™ã€‚
                </div>
                
                <div class="master-section">
                    <div class="master-title">â­ 12æ˜Ÿåº§åŸºæœ¬ãƒ‡ãƒ¼ã‚¿</div>
                    <div class="table-container">
                        <table id="zodiacMasterTable">
                            <thead>
                                <tr>
                                    <th>æ˜Ÿåº§</th>
                                    <th>æœŸé–“</th>
                                    <th>ã‚¨ãƒ¬ãƒ¡ãƒ³ãƒˆ</th>
                                    <th>æ€§è³ª</th>
                                    <th>æ”¯é…æ˜Ÿ</th>
                                </tr>
                            </thead>
                            <tbody id="zodiacMasterBody">
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="master-section">
                    <div class="master-title">ğŸ§  MBTIåŸºæœ¬ãƒ‡ãƒ¼ã‚¿</div>
                    <div class="table-container">
                        <table id="mbtiMasterTable">
                            <thead>
                                <tr>
                                    <th>ã‚¿ã‚¤ãƒ—</th>
                                    <th>æ„›ç§°</th>
                                    <th>ç‰¹å¾´</th>
                                    <th>å¼·ã¿</th>
                                    <th>æ³¨æ„ç‚¹</th>
                                </tr>
                            </thead>
                            <tbody id="mbtiMasterBody">
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="master-section">
                    <div class="master-title">ğŸŒŸ 6æ˜Ÿå è¡“åŸºæœ¬ãƒ‡ãƒ¼ã‚¿</div>
                    <div class="table-container">
                        <table id="sixStarMasterTable">
                            <thead>
                                <tr>
                                    <th>æ˜Ÿäºº</th>
                                    <th>+/-</th>
                                    <th>ç‰¹å¾´</th>
                                    <th>é©è·</th>
                                    <th>æ³¨æ„ç‚¹</th>
                                </tr>
                            </thead>
                            <tbody id="sixStarMasterBody">
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="master-section">
                    <div class="master-title">ğŸ¾ 12å‹•ç‰©åŸºæœ¬ãƒ‡ãƒ¼ã‚¿</div>
                    <div class="table-container">
                        <table id="animalMasterTable">
                            <thead>
                                <tr>
                                    <th>å‹•ç‰©å</th>
                                    <th>å¿—å‘åˆ†é¡</th>
                                    <th>åŸºæœ¬ç‰¹æ€§</th>
                                    <th>å¼·ã¿</th>
                                    <th>æ³¨æ„ç‚¹</th>
                                </tr>
                            </thead>
                            <tbody id="animalMasterBody">
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="master-section">
                    <div class="master-title">ğŸ§˜ ä½“ç™–åˆ†é¡ãƒ‡ãƒ¼ã‚¿</div>
                    <div class="table-container">
                        <table id="taihekiMasterTable">
                            <thead>
                                <tr>
                                    <th>ä½“ç™–ç•ªå·</th>
                                    <th>åˆ†é¡</th>
                                    <th>ç‰¹å¾´</th>
                                    <th>è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³</th>
                                    <th>é©è·å‚¾å‘</th>
                                </tr>
                            </thead>
                            <tbody id="taihekiMasterBody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- è¨­å®šã‚¿ãƒ– -->
            <div id="settings" class="tab-content">
                <div class="info-text">
                    <strong>âš™ï¸ ã‚·ã‚¹ãƒ†ãƒ è¨­å®š</strong><br>
                    ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ç®¡ç†è¨­å®šã¨ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚
                </div>
                
                <div class="master-section">
                    <div class="master-title">ğŸ“‹ ãƒ‡ãƒ¼ã‚¿ç®¡ç†è¨­å®š</div>
                    <p><strong>æ›´æ–°é »åº¦:</strong> æ¯å›ã‚»ãƒƒã‚·ãƒ§ãƒ³å¾Œ</p>
                    <p><strong>ãƒ‡ãƒ¼ã‚¿ä¿è­·:</strong> å®Ÿåç®¡ç†ï¼ˆå³é‡ç®¡ç†ï¼‰</p>
                    <p><strong>åˆ†ææ©Ÿèƒ½:</strong> ç°¡å˜ãªé›†è¨ˆãƒ»ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ</p>
                    <p><strong>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—:</strong> Excelå½¢å¼ã§ã®å®šæœŸã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ¨å¥¨</p>
                </div>
                
                <div class="master-section">
                    <div class="master-title">ğŸ¤– Claude AI é€£æºä»•æ§˜</div>
                    <p><strong>èª­ã¿å–ã‚Šå½¢å¼:</strong> æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒã‚¹ã‚¿ãƒ¼/ã‚¹ãƒ¬ãƒ¼ãƒ–åŸå‰‡ï¼‰</p>
                    <p><strong>åˆ†æå¯¾è±¡:</strong> ãƒ‘ã‚¿ãƒ¼ãƒ³èªè­˜ã€è¨ºæ–­ç²¾åº¦å‘ä¸Šã€ã‚µãƒ¼ãƒ“ã‚¹æ”¹å–„</p>
                    <p><strong>ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼:</strong> å€‹äººè­˜åˆ¥æƒ…å ±ã¯åˆ†ææ™‚ã«é©åˆ‡ã«å‡¦ç†</p>
                </div>
                
                <div class="master-section">
                    <div class="master-title">ğŸ“ˆ ä»Šå¾Œã®æ‹¡å¼µè¨ˆç”»</div>
                    <p><strong>Phase 1:</strong> è¨ºæ–­ãƒ‡ãƒ¼ã‚¿è“„ç©ï¼ˆç¾åœ¨ï¼‰</p>
                    <p><strong>Phase 2:</strong> ãƒ‘ã‚¿ãƒ¼ãƒ³åˆ†æãƒ»ç²¾åº¦æ”¹å–„</p>
                    <p><strong>Phase 3:</strong> ã‚µãƒ¼ãƒ“ã‚¹ãƒªãƒªãƒ¼ã‚¹ãƒ»å®Ÿé‹ç”¨</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
        let diagnosisRecords = [
            {
                id: 1,
                date: "2024-01-15",
                name: "ç”°ä¸­ç¾å’²",
                birthDate: "1992/03/15",
                age: 32,
                gender: "å¥³æ€§",
                zodiac: "é­šåº§",
                animal: "ã“ã˜ã‹",
                orientation: "äººå¿—å‘",
                color: "ã‚°ãƒªãƒ¼ãƒ³",
                mbti: "INFP",
                mainTaiheki: "2",
                subTaiheki: "4",
                sixStar: "åœŸæ˜Ÿäºº+",
                theme: "è»¢è·,ã‚­ãƒ£ãƒªã‚¢,æ‚©ã¿",
                advice: "äººé–“é–¢ä¿‚ã‚’é‡è¦–ã—ãŸè·å ´é¸ã³ãŒé‡è¦ã€‚æ®µéšçš„ãªã‚­ãƒ£ãƒªã‚¢ãƒã‚§ãƒ³ã‚¸ã‚’æ¨å¥¨",
                satisfaction: "5",
                duration: "45åˆ†",
                feedback: "ã¨ã¦ã‚‚çš„ç¢ºãªã‚¢ãƒ‰ãƒã‚¤ã‚¹ã§ã—ãŸã€‚ä½“ç™–ã®èª¬æ˜ãŒç‰¹ã«ç´å¾—ã§ãã¾ã—ãŸã€‚",
                reportUrl: "https://example.com/report/001",
                interviewScheduled: "2024-01-22",
                interviewDone: "2024-01-22",
                memo: "éå¸¸ã«å…±æ„ŸåŠ›ãŒé«˜ã„ã€‚ãƒãƒ¼ãƒ é‡è¦–ã®è·å ´ãŒé©ã—ã¦ã„ã‚‹"
            },
            {
                id: 2,
                date: "2024-01-18",
                name: "ä½è—¤å¥ä¸€",
                birthDate: "1985/07/22",
                age: 39,
                gender: "ç”·æ€§",
                zodiac: "èŸ¹åº§",
                animal: "ãƒ©ã‚¤ã‚ªãƒ³",
                orientation: "å¤§ç‰©å¿—å‘",
                color: "ã‚´ãƒ¼ãƒ«ãƒ‰",
                mbti: "ENTJ",
                mainTaiheki: "7",
                subTaiheki: "5",
                sixStar: "ç«æ˜Ÿäºº-",
                theme: "èµ·æ¥­,äº‹æ¥­æ‹¡å¤§,çµŒå–¶",
                advice: "ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã‚’æ´»ã‹ã—ãŸäº‹æ¥­å±•é–‹ã€‚å¨å³ã‚’ä¿ã¡ã¤ã¤æŸ”è»Ÿæ€§ã‚‚å¿…è¦",
                satisfaction: "4",
                duration: "60åˆ†",
                feedback: "ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã«ã¤ã„ã¦ã®åˆ†æãŒå‚è€ƒã«ãªã‚Šã¾ã—ãŸã€‚",
                reportUrl: "https://example.com/report/002",
                interviewScheduled: "2024-01-25",
                interviewDone: "",
                memo: "å¼·ã„ã‚«ãƒªã‚¹ãƒæ€§ã‚ã‚Šã€‚å®Œç’§ä¸»ç¾©å‚¾å‘ã«æ³¨æ„"
            },
            {
                id: 3,
                date: "2024-01-20",
                name: "å±±ç”°èŠ±å­",
                birthDate: "1998/11/08",
                age: 26,
                gender: "å¥³æ€§",
                zodiac: "è åº§",
                animal: "ã‚ªã‚ªã‚«ãƒŸ",
                orientation: "åŸå¿—å‘",
                color: "ã‚·ãƒ«ãƒãƒ¼",
                mbti: "INTJ",
                mainTaiheki: "1",
                subTaiheki: "9",
                sixStar: "æœ¨æ˜Ÿäºº+",
                theme: "äººé–“é–¢ä¿‚,ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³",
                advice: "ç‹¬ç«‹æ€§ã‚’æ´»ã‹ã—ã¤ã¤ã€å°‘æ•°ç²¾é‹­ã®æ·±ã„é–¢ä¿‚æ€§ã‚’æ§‹ç¯‰ã™ã‚‹ã“ã¨ã‚’æ¨å¥¨",
                satisfaction: "5",
                duration: "40åˆ†",
                feedback: "ä¸€äººã®æ™‚é–“ã®å¤§åˆ‡ã•ã«ã¤ã„ã¦æ”¹ã‚ã¦æ°—ã¥ã‹ã•ã‚Œã¾ã—ãŸã€‚",
                reportUrl: "https://example.com/report/003",
                interviewScheduled: "2024-01-27",
                interviewDone: "2024-01-27",
                memo: "ä¸€äººã®æ™‚é–“ã‚’å¤§åˆ‡ã«ã™ã‚‹ã‚¿ã‚¤ãƒ—ã€‚é›†ä¸­åŠ›ãŒéå¸¸ã«é«˜ã„"
            },
            {
                id: 4,
                date: "2024-01-23",
                name: "éˆ´æœ¨å¤ªéƒ",
                birthDate: "1990/05/30",
                age: 34,
                gender: "ç”·æ€§",
                zodiac: "åŒå­åº§",
                animal: "ãƒãƒ¼ã‚¿ãƒ¼",
                orientation: "å¤§ç‰©å¿—å‘",
                color: "ã‚ªãƒ¬ãƒ³ã‚¸",
                mbti: "ESTP",
                mainTaiheki: "5",
                subTaiheki: "3",
                sixStar: "æ°´æ˜Ÿäºº-",
                theme: "æ‹æ„›,çµå©š,ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã‚·ãƒƒãƒ—",
                advice: "ã‚¹ãƒ”ãƒ¼ãƒ‰æ„Ÿã‚’æ´»ã‹ã—ãŸç©æ¥µçš„ãªã‚¢ãƒ—ãƒ­ãƒ¼ãƒã€‚é•·æœŸçš„è¦–ç‚¹ã‚‚å¿…è¦",
                satisfaction: "4",
                duration: "35åˆ†",
                feedback: "è¡Œå‹•åŠ›ã«ã¤ã„ã¦è¤’ã‚ã‚‰ã‚Œã¦å¬‰ã—ã‹ã£ãŸã§ã™ã€‚ç¶™ç¶šã®ã‚³ãƒ„ã‚‚æ•™ã‚ã‚Šã¾ã—ãŸã€‚",
                reportUrl: "https://example.com/report/004",
                interviewScheduled: "2024-01-30",
                interviewDone: "",
                memo: "è¡Œå‹•åŠ›æŠœç¾¤ã€‚ç¶™ç¶šæ€§ã«èª²é¡Œã‚ã‚Š"
            },
            {
                id: 5,
                date: "2024-01-25",
                name: "é«˜æ©‹æ„›",
                birthDate: "1987/09/12",
                age: 37,
                gender: "å¥³æ€§",
                zodiac: "ä¹™å¥³åº§",
                animal: "ã²ã¤ã˜",
                orientation: "äººå¿—å‘",
                color: "ãƒ‘ãƒ¼ãƒ—ãƒ«",
                mbti: "ISFJ",
                mainTaiheki: "4",
                subTaiheki: "2",
                sixStar: "é‡‘æ˜Ÿäºº+",
                theme: "å­è‚²ã¦,å®¶æ—é–¢ä¿‚,è‚²å…",
                advice: "èª¿æ•´å½¹ã¨ã—ã¦å®¶æ—ã‚’ã¾ã¨ã‚ã‚‹åŠ›ã‚’æ´»ç”¨ã€‚è‡ªå·±çŠ ç‰²ã«æ³¨æ„",
                satisfaction: "5",
                duration: "50åˆ†",
                feedback: "è‡ªå·±çŠ ç‰²ã«ã¤ã„ã¦ã®æŒ‡æ‘˜ãŒæ·±ãåˆºã•ã‚Šã¾ã—ãŸã€‚ãƒãƒ©ãƒ³ã‚¹ã‚’è€ƒãˆã¾ã™ã€‚",
                reportUrl: "https://example.com/report/005",
                interviewScheduled: "2024-02-01",
                interviewDone: "2024-02-01",
                memo: "å®¶æ—æ€ã„ã€‚å‘¨å›²ã¸ã®é…æ…®ãŒè¡Œãéãã‚‹å‚¾å‘"
            },
            {
                id: 6,
                date: "2024-01-28",
                name: "ä¸­æ‘èª ",
                birthDate: "1995/01/25",
                age: 29,
                gender: "ç”·æ€§",
                zodiac: "æ°´ç“¶åº§",
                animal: "ãƒšã‚¬ã‚µã‚¹",
                orientation: "å¤§ç‰©å¿—å‘",
                color: "ãƒ–ãƒ«ãƒ¼",
                mbti: "ENFP",
                mainTaiheki: "6",
                subTaiheki: "10",
                sixStar: "å¤©ç‹æ˜Ÿäºº-",
                theme: "å‰µä½œæ´»å‹•,èŠ¸è¡“,ã‚¯ãƒªã‚¨ã‚¤ãƒ†ã‚£ãƒ–",
                advice: "è‡ªç”±ãªç™ºæƒ³åŠ›ã‚’æ´»ã‹ã—ãŸå‰µé€ çš„æ´»å‹•ã€‚ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ãƒ¯ãƒ¼ã‚¯ã¯é¿ã‘ã‚‹",
                satisfaction: "4",
                duration: "55åˆ†",
                feedback: "å‰µä½œã«å¯¾ã™ã‚‹å§¿å‹¢ã«ã¤ã„ã¦æ–°ã—ã„è¦–ç‚¹ã‚’ã‚‚ã‚‰ã„ã¾ã—ãŸã€‚",
                reportUrl: "https://example.com/report/006",
                interviewScheduled: "2024-02-04",
                interviewDone: "",
                memo: "ç‹¬å‰µçš„ãªã‚¢ã‚¤ãƒ‡ã‚¢è±Šå¯Œã€‚æ°—åˆ†ã®æ³¢ãŒæ¿€ã—ã„"
            },
            {
                id: 7,
                date: "2024-02-02",
                name: "å°æ—éº»ç¾",
                birthDate: "1993/06/18",
                age: 31,
                gender: "å¥³æ€§",
                zodiac: "åŒå­åº§",
                animal: "é»’ã²ã‚‡ã†",
                orientation: "äººå¿—å‘",
                color: "ãƒ–ãƒ©ãƒƒã‚¯",
                mbti: "INFJ",
                mainTaiheki: "3",
                subTaiheki: "1",
                sixStar: "ç«æ˜Ÿäºº+",
                theme: "è‡ªå·±å®Ÿç¾,ã‚¹ãƒ”ãƒªãƒãƒ¥ã‚¢ãƒ«,æˆé•·",
                advice: "ã‚¹ãƒãƒ¼ãƒˆã•ã¨æ­£ç¾©æ„Ÿã‚’æ´»ã‹ã—ãŸç¤¾ä¼šè²¢çŒ®æ´»å‹•ã€‚å“ä½ã‚’ä¿ã¤ã“ã¨ãŒé‡è¦",
                satisfaction: "5",
                duration: "65åˆ†",
                feedback: "ã‚¹ãƒ”ãƒªãƒãƒ¥ã‚¢ãƒ«ãªå´é¢ã‚‚å«ã‚ã¦ä¸å¯§ã«åˆ†æã—ã¦ã„ãŸã ã‘ã¾ã—ãŸã€‚",
                reportUrl: "https://example.com/report/007",
                interviewScheduled: "2024-02-09",
                interviewDone: "2024-02-09",
                memo: "ç¾æ„è­˜ãŒé«˜ã„ã€‚ç†æƒ³ä¸»ç¾©çš„å‚¾å‘å¼·ã„"
            },
            {
                id: 8,
                date: "2024-02-05",
                name: "ä¼Šè—¤å¤§è¼”",
                birthDate: "1988/12/03",
                age: 36,
                gender: "ç”·æ€§",
                zodiac: "å°„æ‰‹åº§",
                animal: "ã¨ã‚‰",
                orientation: "åŸå¿—å‘",
                color: "ãƒ–ãƒ©ã‚¦ãƒ³",
                mbti: "ISTJ",
                mainTaiheki: "8",
                subTaiheki: "7",
                sixStar: "åœŸæ˜Ÿäºº-",
                theme: "ç®¡ç†è·,ãƒãƒ¼ãƒ é‹å–¶,ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—",
                advice: "åŒ…å®¹åŠ›ã¨æ…é‡ã•ã‚’æ´»ã‹ã—ãŸå®‰å®šçš„ãªãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã€‚æ±ºæ–­åŠ›ã®å‘ä¸ŠãŒèª²é¡Œ",
                satisfaction: "4",
                duration: "42åˆ†",
                feedback: "ç®¡ç†è·ã¨ã—ã¦ã®èª²é¡ŒãŒæ˜ç¢ºã«ãªã‚Šã¾ã—ãŸã€‚",
                reportUrl: "https://example.com/report/008",
                interviewScheduled: "2024-02-12",
                interviewDone: "",
                memo: "é¢å€’è¦‹ãŒè‰¯ã„ã€‚ä¿å®ˆçš„ã§å¤‰åŒ–ã‚’å«Œã†"
            },
            {
                id: 9,
                date: "2024-02-08",
                name: "æ¸¡è¾ºã•ãã‚‰",
                birthDate: "1996/04/14",
                age: 28,
                gender: "å¥³æ€§",
                zodiac: "ç‰¡ç¾Šåº§",
                animal: "ã•ã‚‹",
                orientation: "åŸå¿—å‘",
                color: "ãƒ¬ãƒƒãƒ‰",
                mbti: "ESFP",
                mainTaiheki: "5",
                subTaiheki: "3",
                sixStar: "æœ¨æ˜Ÿäºº-",
                theme: "ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³,å¯¾äººé–¢ä¿‚",
                advice: "æ„›å¬Œã¨å™¨ç”¨ã•ã‚’æ´»ã‹ã—ãŸçŸ­æœŸé›†ä¸­å‹ã®å–ã‚Šçµ„ã¿ã€‚é£½ãã£ã½ã•ã«æ³¨æ„",
                satisfaction: "5",
                duration: "38åˆ†",
                feedback: "é£½ãã£ã½ã•å¯¾ç­–ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹ãŒå®Ÿç”¨çš„ã§ã—ãŸã€‚",
                reportUrl: "https://example.com/report/009",
                interviewScheduled: "2024-02-15",
                interviewDone: "2024-02-15",
                memo: "ãƒ ãƒ¼ãƒ‰ãƒ¡ãƒ¼ã‚«ãƒ¼ã€‚é›†ä¸­åŠ›ã®æŒç¶šãŒèª²é¡Œ"
            },
            {
                id: 10,
                date: "2024-02-11",
                name: "æ¾æœ¬å’Œä¹Ÿ",
                birthDate: "1991/10/27",
                age: 33,
                gender: "ç”·æ€§",
                zodiac: "è åº§",
                animal: "ã‚¾ã‚¦",
                orientation: "å¤§ç‰©å¿—å‘",
                color: "ã‚°ãƒ¬ãƒ¼",
                mbti: "ISTP",
                mainTaiheki: "9",
                subTaiheki: "1",
                sixStar: "æ°´æ˜Ÿäºº+",
                theme: "æŠ€è¡“ç¿’å¾—,å°‚é–€æ€§,ã‚¹ã‚­ãƒ«ã‚¢ãƒƒãƒ—",
                advice: "è·äººæ°—è³ªã‚’æ´»ã‹ã—ãŸå°‚é–€åˆ†é‡ã®æ·±å €ã‚Šã€‚ç¶™ç¶šçš„ãªåŠªåŠ›ã§å¤§ããªæˆæœãŒæœŸå¾…ã§ãã‚‹",
                satisfaction: "4",
                duration: "48åˆ†",
                feedback: "å°‚é–€æ€§ã‚’æ´»ã‹ã™æ–¹å‘æ€§ãŒè¦‹ãˆã¦å®‰å¿ƒã—ã¾ã—ãŸã€‚",
                reportUrl: "https://example.com/report/010",
                interviewScheduled: "2024-02-18",
                interviewDone: "",
                memo: "ç²˜ã‚Šå¼·ã„åŠªåŠ›å®¶ã€‚ç‹¬æ–­çš„ã«ãªã‚Šã‚„ã™ã„"
            }
        ];
        
        // ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿
        const animalMasterData = [
            {animal: "ã‚ªã‚ªã‚«ãƒŸ", orientation: "åŸå¿—å‘", trait: "ç‹¬ç«‹ãƒ»è·äººæ°—è³ª", strength: "é›†ä¸­åŠ›ãƒ»ç‹¬å‰µæ€§", caution: "å”èª¿æ€§ãƒ»èª¬æ˜ä¸è¶³"},
            {animal: "ã“ã˜ã‹", orientation: "äººå¿—å‘", trait: "ç´”ç²‹ãƒ»æ…é‡", strength: "èª å®Ÿãƒ»å…±æ„ŸåŠ›", caution: "å‚·ã¤ãã‚„ã™ã„ãƒ»ä¾å­˜"},
            {animal: "ã•ã‚‹", orientation: "åŸå¿—å‘", trait: "æ„›å¬Œãƒ»å™¨ç”¨", strength: "ãƒ ãƒ¼ãƒ‰ãƒ¡ã‚¤ã‚¯ãƒ»é©å¿œåŠ›", caution: "é£½ãã‚„ã™ã„ãƒ»æ—©åˆç‚¹"},
            {animal: "ãƒãƒ¼ã‚¿ãƒ¼", orientation: "å¤§ç‰©å¿—å‘", trait: "æŒ‘æˆ¦ãƒ»ã‚¹ãƒ”ãƒ¼ãƒ‰", strength: "ç¬ç™ºåŠ›ãƒ»çªç ´åŠ›", caution: "ç¶™ç¶šæ€§ãƒ»é›‘ã«ãªã‚ŠãŒã¡"},
            {animal: "é»’ã²ã‚‡ã†", orientation: "äººå¿—å‘", trait: "ã‚¹ãƒãƒ¼ãƒˆãƒ»æ­£ç¾©æ„Ÿ", strength: "å…ˆå°åŠ›ãƒ»ç¤¾äº¤æ€§", caution: "æ‰¹åˆ¤çš„ãƒ»å‚·ã¤ãã‚„ã™ã„"},
            {animal: "ãƒ©ã‚¤ã‚ªãƒ³", orientation: "å¤§ç‰©å¿—å‘", trait: "å¨å³ãƒ»å®Œç’§ä¸»ç¾©", strength: "çµ±ç‡åŠ›ãƒ»ä¿¡é ¼æ„Ÿ", caution: "å³ã—ã•ãƒ»æŸ”è»Ÿæ€§ä¸è¶³"},
            {animal: "ã¨ã‚‰", orientation: "åŸå¿—å‘", trait: "åŒ…å®¹ãƒ»æ…é‡", strength: "é¢å€’è¦‹ãƒ»å …å®Ÿæ€§", caution: "æ±ºæ–­åŠ›ãƒ»ä¿å®ˆçš„"},
            {animal: "ãŸã¬ã", orientation: "äººå¿—å‘", trait: "é£„ã€…ãƒ»å¤é¢¨", strength: "æ„›å¬Œãƒ»èª¿æ•´åŠ›", caution: "ã†ã£ã‹ã‚Šãƒ»å®Ÿè¡ŒåŠ›"},
            {animal: "ã‚³ã‚¢ãƒ©", orientation: "åŸå¿—å‘", trait: "ãƒ­ãƒãƒ³ãƒ»ç”¨å¿ƒæ·±ã„", strength: "è¨ˆç”»æ€§ãƒ»æƒ…ã®åšã•", caution: "ç–‘ã„æ·±ã„ãƒ»æ…é‡éå¤š"},
            {animal: "ã‚¾ã‚¦", orientation: "å¤§ç‰©å¿—å‘", trait: "æ­£é¢çªç ´ãƒ»è·äºº", strength: "ç²˜ã‚Šå¼·ã•ãƒ»æ´å¯ŸåŠ›", caution: "ç‹¬æ–­ãƒ»é ‘å›º"},
            {animal: "ã²ã¤ã˜", orientation: "äººå¿—å‘", trait: "å…±åŠ©ãƒ»æ€ã„ã‚„ã‚Š", strength: "èª¿æ•´åŠ›ãƒ»èª å®Ÿã•", caution: "è‡ªå·±çŠ ç‰²ãƒ»æ„šç—´"},
            {animal: "ãƒšã‚¬ã‚µã‚¹", orientation: "å¤§ç‰©å¿—å‘", trait: "è‡ªç”±å¥”æ”¾ãƒ»ç›´æ„Ÿ", strength: "ç™ºæƒ³åŠ›ãƒ»äººè„ˆ", caution: "æ°—åˆ†ãƒ ãƒ©ãƒ»è¦å‰‡å«Œã„"}
        ];
        
        const taihekiMasterData = [
            {number: "1", type: "ä¸Šä¸‹å‹ãƒ»é ­è„³å‹ãƒ»å¥‡æ•°", trait: "ãƒ­ã‚¸ã‚«ãƒ«ãƒ»ç†å±ˆå¥½ã", pattern: "æ€è€ƒå…ˆè¡Œãƒ»ç†è«–é‡è¦–", career: "å­¦è€…ãƒ»ç ”ç©¶è·ãƒ»å¼è­·å£«"},
            {number: "2", type: "ä¸Šä¸‹å‹ãƒ»é ­è„³å‹ãƒ»å¶æ•°", trait: "ã‚¤ãƒ¡ãƒ¼ã‚¸æ€è€ƒãƒ»çœŸé¢ç›®", pattern: "æº–å‚™é‡è¦–ãƒ»å—ã‘èº«", career: "ã‚µãƒ©ãƒªãƒ¼ãƒãƒ³ãƒ»äº‹å‹™è·"},
            {number: "3", type: "å·¦å³å‹ãƒ»æ¶ˆåŒ–å™¨å‹ãƒ»å¥‡æ•°", trait: "æ„Ÿæƒ…è±Šã‹ãƒ»ãƒ ãƒ¼ãƒ‰ãƒ¡ãƒ¼ã‚«ãƒ¼", pattern: "å¥½ãå«Œã„ã§åˆ¤æ–­", career: "æ¥å®¢æ¥­ãƒ»å–¶æ¥­ãƒ»èŠ¸èƒ½"},
            {number: "4", type: "å·¦å³å‹ãƒ»æ¶ˆåŒ–å™¨å‹ãƒ»å¶æ•°", trait: "ã‚¯ãƒ¼ãƒ«ãƒ»å…±æ„Ÿèƒ½åŠ›", pattern: "ç’°å¢ƒé‡è¦–ãƒ»å¯„ã‚Šæ·»ã„", career: "ã‚«ã‚¦ãƒ³ã‚»ãƒ©ãƒ¼ãƒ»ã‚µãƒ¼ãƒ“ã‚¹æ¥­"},
            {number: "5", type: "å‰å¾Œå‹ãƒ»å‘¼å¸å™¨å‹ãƒ»å¥‡æ•°", trait: "è¡Œå‹•çš„ãƒ»åˆç†ä¸»ç¾©", pattern: "ä¸¦è¡Œå‡¦ç†ãƒ»æå¾—é‡è¦–", career: "å–¶æ¥­ãƒ»ã‚¹ãƒãƒ¼ãƒ„ãƒ»èµ·æ¥­å®¶"},
            {number: "6", type: "å‰å¾Œå‹ãƒ»å‘¼å¸å™¨å‹ãƒ»å¶æ•°", trait: "ç´”ç²‹ãƒ»ç†æƒ³å®¶", pattern: "é™ã‹ãƒ»éæ—¥å¸¸ã§æ´»æ€§", career: "èŠ¸è¡“å®¶ãƒ»é©å‘½å®¶ãƒ»å®—æ•™"},
            {number: "7", type: "æ»ã‚Œå‹ãƒ»å¥‡æ•°ãƒ»æ³Œå°¿å™¨å‹", trait: "é—˜å£«ãƒ»è¦ªåˆ†è‚Œ", pattern: "ç«¶äº‰ãƒ»æ‰‹å¿œãˆé‡è¦–", career: "çµŒå–¶è€…ãƒ»è»äººãƒ»ã‚¹ãƒãƒ¼ãƒ„"},
            {number: "8", type: "æ»ã‚Œå‹ãƒ»å¶æ•°ãƒ»æ³Œå°¿å™¨å‹", trait: "æˆ‘æ…¢å¼·ã„ãƒ»ç¾©ç†å …ã„", pattern: "åœ°é“ãªåŠªåŠ›ãƒ»æ­£ç¾©æ„Ÿ", career: "è·äººãƒ»å®—æ•™å®¶ãƒ»æŒ‡å°è€…"},
            {number: "9", type: "é–‹é–‰å‹ãƒ»å¥‡æ•°ãƒ»ç”Ÿæ®–å™¨å‹", trait: "å‡ã‚Šæ€§ãƒ»å®Œç’§ä¸»ç¾©", pattern: "åŸ·ç€ãƒ»æ ¹æºè¿½æ±‚", career: "ç ”ç©¶è€…ãƒ»è·äººãƒ»èŠ¸è¡“å®¶"},
            {number: "10", type: "é–‹é–‰å‹ãƒ»å¶æ•°ãƒ»ç”Ÿæ®–å™¨å‹", trait: "è¦ªåˆ†è‚Œãƒ»å¯›å®¹", pattern: "ä¸–è©±å¥½ããƒ»åšæ„›", career: "ç¤¾é•·ãƒ»æ•™è‚²è€…ãƒ»ç¦ç¥‰"}
        ];
        
        const zodiacMasterData = [
            {zodiac: "ç‰¡ç¾Šåº§", period: "3/21-4/19", element: "ç«", nature: "æ´»å‹•å®®", ruler: "ç«æ˜Ÿ"},
            {zodiac: "ç‰¡ç‰›åº§", period: "4/20-5/20", element: "åœ°", nature: "å›ºå®šå®®", ruler: "é‡‘æ˜Ÿ"},
            {zodiac: "åŒå­åº§", period: "5/21-6/21", element: "é¢¨", nature: "æŸ”è»Ÿå®®", ruler: "æ°´æ˜Ÿ"},
            {zodiac: "èŸ¹åº§", period: "6/22-7/22", element: "æ°´", nature: "æ´»å‹•å®®", ruler: "æœˆ"},
            {zodiac: "ç…å­åº§", period: "7/23-8/22", element: "ç«", nature: "å›ºå®šå®®", ruler: "å¤ªé™½"},
            {zodiac: "ä¹™å¥³åº§", period: "8/23-9/22", element: "åœ°", nature: "æŸ”è»Ÿå®®", ruler: "æ°´æ˜Ÿ"},
            {zodiac: "å¤©ç§¤åº§", period: "9/23-10/23", element: "é¢¨", nature: "æ´»å‹•å®®", ruler: "é‡‘æ˜Ÿ"},
            {zodiac: "è åº§", period: "10/24-11/22", element: "æ°´", nature: "å›ºå®šå®®", ruler: "å†¥ç‹æ˜Ÿ"},
            {zodiac: "å°„æ‰‹åº§", period: "11/23-12/21", element: "ç«", nature: "æŸ”è»Ÿå®®", ruler: "æœ¨æ˜Ÿ"},
            {zodiac: "å±±ç¾Šåº§", period: "12/22-1/19", element: "åœ°", nature: "æ´»å‹•å®®", ruler: "åœŸæ˜Ÿ"},
            {zodiac: "æ°´ç“¶åº§", period: "1/20-2/18", element: "é¢¨", nature: "å›ºå®šå®®", ruler: "å¤©ç‹æ˜Ÿ"},
            {zodiac: "é­šåº§", period: "2/19-3/20", element: "æ°´", nature: "æŸ”è»Ÿå®®", ruler: "æµ·ç‹æ˜Ÿ"}
        ];
        
        const mbtiMasterData = [
            {type: "INTJ", nickname: "å»ºç¯‰å®¶", trait: "ç‹¬ç«‹å¿ƒãƒ»æˆ¦ç•¥çš„", strength: "é•·æœŸè¨ˆç”»ãƒ»é©æ–°", caution: "å®Œç’§ä¸»ç¾©ãƒ»å­¤ç«‹"},
            {type: "INTP", nickname: "è«–ç†å­¦è€…", trait: "ç†è«–çš„ãƒ»å¥½å¥‡å¿ƒ", strength: "åˆ†æåŠ›ãƒ»å®¢è¦³æ€§", caution: "å®Ÿè¡ŒåŠ›ãƒ»æ„Ÿæƒ…ç†è§£"},
            {type: "ENTJ", nickname: "æŒ‡æ®å®˜", trait: "ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ãƒ»åŠ¹ç‡", strength: "çµ±ç‡åŠ›ãƒ»æ±ºæ–­åŠ›", caution: "å¼·å¼•ãƒ»æ„Ÿæƒ…è»½è¦–"},
            {type: "ENTP", nickname: "è¨è«–è€…", trait: "é©æ–°çš„ãƒ»æŸ”è»Ÿ", strength: "ç™ºæƒ³åŠ›ãƒ»é©å¿œæ€§", caution: "é£½ãã‚„ã™ã•ãƒ»ç¶™ç¶šæ€§"},
            {type: "INFJ", nickname: "æå”±è€…", trait: "ç†æƒ³ä¸»ç¾©ãƒ»æ´å¯Ÿ", strength: "å…±æ„ŸåŠ›ãƒ»å…ˆè¦‹æ€§", caution: "å®Œç’§ä¸»ç¾©ãƒ»ç‡ƒãˆå°½ã"},
            {type: "INFP", nickname: "ä»²ä»‹è€…", trait: "ä¾¡å€¤è¦³ãƒ»å‰µé€ æ€§", strength: "å€‹æ€§ãƒ»æƒ…ç†±", caution: "æ‰¹åˆ¤æ•æ„Ÿãƒ»ç¾å®Ÿé€ƒé¿"},
            {type: "ENFJ", nickname: "ä¸»äººå…¬", trait: "ã‚«ãƒªã‚¹ãƒãƒ»åˆ©ä»–çš„", strength: "æŒ‡å°åŠ›ãƒ»äººé–“ç†è§£", caution: "éåº¦é…æ…®ãƒ»ç‡ƒãˆå°½ã"},
            {type: "ENFP", nickname: "åºƒå ±é‹å‹•å®¶", trait: "ç†±ç‹‚çš„ãƒ»å‰µé€ çš„", strength: "ã‚³ãƒŸãƒ¥åŠ›ãƒ»ç™ºæƒ³", caution: "é›†ä¸­å›°é›£ãƒ»è¨ˆç”»æ€§"},
            {type: "ISTJ", nickname: "ç®¡ç†è€…", trait: "è²¬ä»»æ„Ÿãƒ»ä¼çµ±", strength: "ä¿¡é ¼æ€§ãƒ»çµ„ç¹”åŠ›", caution: "æŸ”è»Ÿæ€§ãƒ»å¤‰åŒ–å¯¾å¿œ"},
            {type: "ISFJ", nickname: "æ“è­·è€…", trait: "çŒ®èº«çš„ãƒ»å”èª¿", strength: "ã‚µãƒãƒ¼ãƒˆãƒ»ç´°ã‚„ã‹", caution: "è‡ªå·±ä¸»å¼µãƒ»éè² è·"},
            {type: "ESTJ", nickname: "å¹¹éƒ¨", trait: "çµ„ç¹”çš„ãƒ»å®Ÿè·µçš„", strength: "ç®¡ç†åŠ›ãƒ»åŠ¹ç‡", caution: "é ‘å›ºãƒ»æ„Ÿæƒ…ç†è§£"},
            {type: "ESFJ", nickname: "é ˜äº‹", trait: "å”èª¿ãƒ»ä¸–è©±å¥½ã", strength: "äººé–“é–¢ä¿‚ãƒ»èª¿å’Œ", caution: "æ‰¹åˆ¤æ•æ„Ÿãƒ»å¤‰åŒ–æ‹’å¦"},
            {type: "ISTP", nickname: "å·¨åŒ ", trait: "å®Ÿç”¨çš„ãƒ»ç‹¬ç«‹", strength: "æŠ€è¡“åŠ›ãƒ»å†·é™", caution: "ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»è¨ˆç”»"},
            {type: "ISFP", nickname: "å†’é™ºå®¶", trait: "èŠ¸è¡“çš„ãƒ»æŸ”è»Ÿ", strength: "å‰µé€ æ€§ãƒ»å€‹æ€§", caution: "è‡ªå·±è¡¨ç¾ãƒ»ç«¶äº‰"},
            {type: "ESTP", nickname: "èµ·æ¥­å®¶", trait: "è¡Œå‹•çš„ãƒ»ç¾å®Ÿçš„", strength: "é©å¿œåŠ›ãƒ»å®Ÿè¡ŒåŠ›", caution: "è¨ˆç”»æ€§ãƒ»ç¶™ç¶šæ€§"},
            {type: "ESFP", nickname: "ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ†ã‚¤ãƒŠãƒ¼", trait: "ç¤¾äº¤çš„ãƒ»è‡ªç”±", strength: "è¡¨ç¾åŠ›ãƒ»æ¥½è¦³æ€§", caution: "é›†ä¸­åŠ›ãƒ»æ‰¹åˆ¤å¯¾å¿œ"}
        ];
        
        const sixStarMasterData = [
            {star: "åœŸæ˜Ÿäºº", plusminus: "+", trait: "çœŸé¢ç›®ãƒ»è²¬ä»»æ„Ÿ", career: "å…¬å‹™å“¡ãƒ»ç ”ç©¶è·", caution: "å®Œç’§ä¸»ç¾©ãƒ»é ‘å›º"},
            {star: "åœŸæ˜Ÿäºº", plusminus: "-", trait: "æ…é‡ãƒ»åˆ†æçš„", career: "å°‚é–€è·ãƒ»æŠ€è¡“è€…", caution: "æ¶ˆæ¥µçš„ãƒ»å¿ƒé…æ€§"},
            {star: "é‡‘æ˜Ÿäºº", plusminus: "+", trait: "ç¾çš„ã‚»ãƒ³ã‚¹ãƒ»å”èª¿", career: "èŠ¸è¡“ãƒ»æ¥å®¢æ¥­", caution: "å„ªæŸ”ä¸æ–­ãƒ»ä¾å­˜"},
            {star: "é‡‘æ˜Ÿäºº", plusminus: "-", trait: "å¹³å’Œä¸»ç¾©ãƒ»èª¿å’Œ", career: "èª¿æ•´å½¹ãƒ»ç›¸è«‡æ¥­", caution: "æ›–æ˜§ãƒ»æ±ºæ–­åŠ›ä¸è¶³"},
            {star: "ç«æ˜Ÿäºº", plusminus: "+", trait: "è¡Œå‹•åŠ›ãƒ»æƒ…ç†±", career: "å–¶æ¥­ãƒ»ã‚¹ãƒãƒ¼ãƒ„", caution: "çŸ­æ°—ãƒ»è¡å‹•çš„"},
            {star: "ç«æ˜Ÿäºº", plusminus: "-", trait: "é›†ä¸­åŠ›ãƒ»è·äººæ°—è³ª", career: "æŠ€è¡“è·ãƒ»ç ”ç©¶", caution: "é ‘å›ºãƒ»å­¤ç«‹"},
            {star: "å¤©ç‹æ˜Ÿäºº", plusminus: "+", trait: "è‡ªç”±ãƒ»é©æ–°çš„", career: "ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼ãƒ»èµ·æ¥­", caution: "é£½ãã‚„ã™ã„ãƒ»è¦å‰‡å«Œã„"},
            {star: "å¤©ç‹æ˜Ÿäºº", plusminus: "-", trait: "ç‹¬å‰µæ€§ãƒ»ç†æƒ³", career: "èŠ¸è¡“å®¶ãƒ»æ”¹é©è€…", caution: "ç¾å®Ÿé›¢ã‚Œãƒ»å­¤ç‹¬"},
            {star: "æœ¨æ˜Ÿäºº", plusminus: "+", trait: "æ¥½è¦³çš„ãƒ»æ‹¡å¤§å¿—å‘", career: "çµŒå–¶ãƒ»æ•™è‚²", caution: "å¤§é›‘æŠŠãƒ»æµªè²»"},
            {star: "æœ¨æ˜Ÿäºº", plusminus: "-", trait: "æ¢ç©¶å¿ƒãƒ»å“²å­¦çš„", career: "ç ”ç©¶ãƒ»å®—æ•™", caution: "ç†æƒ³ä¸»ç¾©ãƒ»ç¾å®Ÿé€ƒé¿"},
            {star: "æ°´æ˜Ÿäºº", plusminus: "+", trait: "çŸ¥çš„ãƒ»ã‚³ãƒŸãƒ¥åŠ›", career: "ãƒ¡ãƒ‡ã‚£ã‚¢ãƒ»æ•™è‚²", caution: "è¡¨é¢çš„ãƒ»è»½è–„"},
            {star: "æ°´æ˜Ÿäºº", plusminus: "-", trait: "åˆ†æåŠ›ãƒ»æ…é‡", career: "ç ”ç©¶ãƒ»åˆ†æè·", caution: "ç¥çµŒè³ªãƒ»æ‰¹åˆ¤çš„"}
        ];

        function showTab(tabName) {
            // ã™ã¹ã¦ã®ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’éè¡¨ç¤º
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));
            
            // ã™ã¹ã¦ã®ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã‹ã‚‰ active ã‚¯ãƒ©ã‚¹ã‚’å‰Šé™¤
            const buttons = document.querySelectorAll('.tab-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            
            // æŒ‡å®šã•ã‚ŒãŸã‚¿ãƒ–ã‚’è¡¨ç¤º
            document.getElementById(tabName).classList.add('active');
            
            // å¯¾å¿œã™ã‚‹ãƒœã‚¿ãƒ³ã« active ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ 
            event.target.classList.add('active');
            
            // ã‚¿ãƒ–ã«å¿œã˜ã¦ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°
            if (tabName === 'records') {
                updateRecordsTable();
                setTimeout(() => addEditableListeners(), 100);
            } else if (tabName === 'stats') {
                updateStatsView();
            } else if (tabName === 'master') {
                updateMasterData();
            }
        }

        function updateRecordsTable() {
            const tbody = document.getElementById('recordsBody');
            tbody.innerHTML = '';
            
            diagnosisRecords.forEach((record, index) => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${record.id}</td>
                    <td class="editable" data-field="date" data-index="${index}">${record.date}</td>
                    <td class="editable" data-field="name" data-index="${index}">${record.name}</td>
                    <td class="editable" data-field="birthDate" data-index="${index}">${record.birthDate}</td>
                    <td class="editable" data-field="age" data-index="${index}">${record.age}</td>
                    <td class="editable" data-field="gender" data-index="${index}">${record.gender}</td>
                    <td class="editable" data-field="zodiac" data-index="${index}">${record.zodiac}</td>
                    <td class="editable" data-field="animal" data-index="${index}">${record.animal}</td>
                    <td class="auto-field" data-index="${index}">${getOrientationFromAnimal(record.animal)}</td>
                    <td class="editable" data-field="color" data-index="${index}">${record.color}</td>
                    <td class="editable" data-field="mbti" data-index="${index}">${record.mbti}</td>
                    <td class="editable" data-field="mainTaiheki" data-index="${index}">${record.mainTaiheki}</td>
                    <td class="editable" data-field="subTaiheki" data-index="${index}">${record.subTaiheki}</td>
                    <td class="editable" data-field="sixStar" data-index="${index}">${record.sixStar}</td>
                    <td class="editable tag-field" data-field="theme" data-index="${index}">${displayTags(record.theme)}</td>
                    <td class="editable" data-field="advice" data-index="${index}">${record.advice}</td>
                    <td class="editable" data-field="satisfaction" data-index="${index}">${record.satisfaction}â˜…</td>
                    <td class="editable" data-field="duration" data-index="${index}">${record.duration}</td>
                    <td class="editable" data-field="feedback" data-index="${index}">${record.feedback}</td>
                    <td class="editable" data-field="reportUrl" data-index="${index}">${record.reportUrl}</td>
                    <td class="editable" data-field="interviewScheduled" data-index="${index}">${record.interviewScheduled}</td>
                    <td class="editable" data-field="interviewDone" data-index="${index}">${record.interviewDone}</td>
                    <td class="editable" data-field="memo" data-index="${index}">${record.memo}</td>
                `;
            });
            
            // ç·¨é›†å¯èƒ½ã‚»ãƒ«ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ 
            setTimeout(addEditableListeners, 50);
            
            document.getElementById('recordCount').textContent = diagnosisRecords.length;
        }

        function updateStatsView() {
            const statsGrid = document.getElementById('statsGrid');
            statsGrid.innerHTML = '';
            
            // æ€§åˆ¥åˆ†å¸ƒ
            const genderStats = {};
            diagnosisRecords.forEach(r => {
                genderStats[r.gender] = (genderStats[r.gender] || 0) + 1;
            });
            
            // å¹´ä»£åˆ¥åˆ†å¸ƒ
            const ageGroups = {};
            diagnosisRecords.forEach(r => {
                const ageGroup = `${Math.floor(r.age / 10) * 10}ä»£`;
                ageGroups[ageGroup] = (ageGroups[ageGroup] || 0) + 1;
            });
            
            // å‹•ç‰©åˆ†å¸ƒ
            const animalStats = {};
            diagnosisRecords.forEach(r => {
                animalStats[r.animal] = (animalStats[r.animal] || 0) + 1;
            });
            
            // å¿—å‘åˆ†å¸ƒï¼ˆå‹•ç‰©ã‹ã‚‰è‡ªå‹•è¨ˆç®—ï¼‰
            const orientationStats = {};
            diagnosisRecords.forEach(r => {
                const orientation = getOrientationFromAnimal(r.animal);
                orientationStats[orientation] = (orientationStats[orientation] || 0) + 1;
            });
            
            // ç›¸è«‡ãƒ†ãƒ¼ãƒï¼ˆã‚¿ã‚°ï¼‰åˆ†å¸ƒ
            const tagStats = extractTagStats();
            
            // æº€è¶³åº¦åˆ†å¸ƒ
            const satisfactionStats = {};
            diagnosisRecords.forEach(r => {
                satisfactionStats[`${r.satisfaction}â˜…`] = (satisfactionStats[`${r.satisfaction}â˜…`] || 0) + 1;
            });
            
            function createStatsCard(title, data) {
                const card = document.createElement('div');
                card.className = 'stats-card';
                card.innerHTML = `
                    <div class="stats-title">${title}</div>
                    ${Object.entries(data).map(([key, value]) => 
                        `<div class="stats-item">
                            <span>${key}</span>
                            <span><strong>${value}ä»¶</strong></span>
                        </div>`
                    ).join('')}
                `;
                return card;
            }
            
            statsGrid.appendChild(createStatsCard('ğŸ‘¥ æ€§åˆ¥åˆ†å¸ƒ', genderStats));
            statsGrid.appendChild(createStatsCard('ğŸ‚ å¹´ä»£åˆ†å¸ƒ', ageGroups));
            statsGrid.appendChild(createStatsCard('ğŸ¾ å‹•ç‰©åˆ†å¸ƒ', animalStats));
            statsGrid.appendChild(createStatsCard('ğŸ¯ å¿—å‘åˆ†å¸ƒï¼ˆè‡ªå‹•è¨ˆç®—ï¼‰', orientationStats));
            statsGrid.appendChild(createStatsCard('â­ æº€è¶³åº¦åˆ†å¸ƒ', satisfactionStats));
            statsGrid.appendChild(createStatsCard('ğŸ·ï¸ ç›¸è«‡ã‚¿ã‚°åˆ†å¸ƒ', tagStats));
        }

        function updateMasterData() {
            // å‹•ç‰©ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿
            const animalTbody = document.getElementById('animalMasterBody');
            animalTbody.innerHTML = '';
            animalMasterData.forEach(animal => {
                const row = animalTbody.insertRow();
                row.innerHTML = `
                    <td>${animal.animal}</td>
                    <td>${animal.orientation}</td>
                    <td>${animal.trait}</td>
                    <td>${animal.strength}</td>
                    <td>${animal.caution}</td>
                `;
            });
            
            // æ˜Ÿåº§ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿
            const zodiacTbody = document.getElementById('zodiacMasterBody');
            zodiacTbody.innerHTML = '';
            zodiacMasterData.forEach(zodiac => {
                const row = zodiacTbody.insertRow();
                row.innerHTML = `
                    <td>${zodiac.zodiac}</td>
                    <td>${zodiac.period}</td>
                    <td>${zodiac.element}</td>
                    <td>${zodiac.nature}</td>
                    <td>${zodiac.ruler}</td>
                `;
            });
            
            // MBTIãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿
            const mbtiTbody = document.getElementById('mbtiMasterBody');
            mbtiTbody.innerHTML = '';
            mbtiMasterData.forEach(mbti => {
                const row = mbtiTbody.insertRow();
                row.innerHTML = `
                    <td>${mbti.type}</td>
                    <td>${mbti.nickname}</td>
                    <td>${mbti.trait}</td>
                    <td>${mbti.strength}</td>
                    <td>${mbti.caution}</td>
                `;
            });
            
            // 6æ˜Ÿå è¡“ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿
            const sixStarTbody = document.getElementById('sixStarMasterBody');
            sixStarTbody.innerHTML = '';
            sixStarMasterData.forEach(star => {
                const row = sixStarTbody.insertRow();
                row.innerHTML = `
                    <td>${star.star}</td>
                    <td>${star.plusminus}</td>
                    <td>${star.trait}</td>
                    <td>${star.career}</td>
                    <td>${star.caution}</td>
                `;
            });
            
            // ä½“ç™–ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿
            const taihekiTbody = document.getElementById('taihekiMasterBody');
            taihekiTbody.innerHTML = '';
            taihekiMasterData.forEach(taiheki => {
                const row = taihekiTbody.insertRow();
                row.innerHTML = `
                    <td>${taiheki.number}</td>
                    <td>${taiheki.type}</td>
                    <td>${taiheki.trait}</td>
                    <td>${taiheki.pattern}</td>
                    <td>${taiheki.career}</td>
                `;
            });
        }

        function exportToExcel() {
            // ãƒ¯ãƒ¼ã‚¯ãƒ–ãƒƒã‚¯ã‚’ä½œæˆ
            const wb = XLSX.utils.book_new();
            
            // è¨ºæ–­è¨˜éŒ²ã‚·ãƒ¼ãƒˆï¼ˆå¿—å‘ã¯å‹•ç‰©ã‹ã‚‰è‡ªå‹•è¨ˆç®—ã§è¿½åŠ ï¼‰
            const recordsData = [
                ['ID', 'è¨ºæ–­æ—¥æ™‚', 'ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå', 'ç”Ÿå¹´æœˆæ—¥', 'å¹´é½¢', 'æ€§åˆ¥', 'æ˜Ÿåº§', 
                 'å‹•ç‰©å ã„', 'å¿—å‘ï¼ˆè‡ªå‹•ï¼‰', 'è‰²', 'MBTI', 'ä¸»ä½“ç™–', 'å‰¯ä½“ç™–', '6æ˜Ÿå è¡“', 'ç›¸è«‡ãƒ†ãƒ¼ãƒ', 
                 'æä¾›ã‚¢ãƒ‰ãƒã‚¤ã‚¹', 'æº€è¶³åº¦', 'æ‰€è¦æ™‚é–“', 'æ„Ÿæƒ³', 'ä½œæˆãƒ¬ãƒãƒ¼ãƒˆURL',
                 'ã‚¤ãƒ³ã‚¿ãƒ“ãƒ¥ãƒ¼äºˆå®š', 'ã‚¤ãƒ³ã‚¿ãƒ“ãƒ¥ãƒ¼å®Ÿæ–½', 'å‚™è€ƒ'],
                ...diagnosisRecords.map(r => [
                    r.id, r.date, r.name, r.birthDate, r.age, r.gender, r.zodiac,
                    r.animal, getOrientationFromAnimal(r.animal), r.color, r.mbti, r.mainTaiheki, r.subTaiheki, r.sixStar,
                    r.theme, r.advice, r.satisfaction, r.duration, r.feedback, r.reportUrl,
                    r.interviewScheduled, r.interviewDone, r.memo
                ])
            ];
            const ws1 = XLSX.utils.aoa_to_sheet(recordsData);
            XLSX.utils.book_append_sheet(wb, ws1, 'è¨ºæ–­è¨˜éŒ²');
            
            // çµ±è¨ˆãƒ‡ãƒ¼ã‚¿ã‚·ãƒ¼ãƒˆ
            const genderStats = {};
            const animalStats = {};
            const orientationStats = {};
            const tagStats = extractTagStats();
            diagnosisRecords.forEach(r => {
                genderStats[r.gender] = (genderStats[r.gender] || 0) + 1;
                animalStats[r.animal] = (animalStats[r.animal] || 0) + 1;
                const orientation = getOrientationFromAnimal(r.animal);
                orientationStats[orientation] = (orientationStats[orientation] || 0) + 1;
            });
            
            const statsData = [
                ['çµ±è¨ˆé …ç›®', 'ã‚«ãƒ†ã‚´ãƒª', 'ä»¶æ•°'],
                ...Object.entries(genderStats).map(([k, v]) => ['æ€§åˆ¥', k, v]),
                ...Object.entries(animalStats).map(([k, v]) => ['å‹•ç‰©', k, v]),
                ...Object.entries(orientationStats).map(([k, v]) => ['å¿—å‘', k, v]),
                ...Object.entries(tagStats).map(([k, v]) => ['ç›¸è«‡ã‚¿ã‚°', k, v])
            ];
            const ws2 = XLSX.utils.aoa_to_sheet(statsData);
            XLSX.utils.book_append_sheet(wb, ws2, 'çµ±è¨ˆåˆ†æ');
            
            // ãƒ•ã‚¡ã‚¤ãƒ«å‡ºåŠ›
            const filename = `å ã„å¸«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ_è¨ºæ–­ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹_${new Date().toISOString().slice(0, 10)}.xlsx`;
            XLSX.writeFile(wb, filename);
        }

        // ã‚¿ã‚°è¡¨ç¤ºæ©Ÿèƒ½
        function displayTags(tagString) {
            if (!tagString || tagString === 'æ–°è¦ç›¸è«‡') return tagString;
            const tags = tagString.split(',').map(tag => tag.trim()).filter(tag => tag);
            return tags.map(tag => `<span class="tag">${tag}</span>`).join('');
        }
        
        // ã‚¿ã‚°çµ±è¨ˆã‚’æŠ½å‡º
        function extractTagStats() {
            const tagStats = {};
            diagnosisRecords.forEach(record => {
                if (record.theme && record.theme !== 'æ–°è¦ç›¸è«‡') {
                    const tags = record.theme.split(',').map(tag => tag.trim()).filter(tag => tag);
                    tags.forEach(tag => {
                        tagStats[tag] = (tagStats[tag] || 0) + 1;
                    });
                }
            });
            return tagStats;
        }

        // å‹•ç‰©å ã„ã‹ã‚‰å¿—å‘ã‚’è‡ªå‹•åˆ¤å®š
        function getOrientationFromAnimal(animal) {
            const orientationMap = {
                'ã“ã˜ã‹': 'äººå¿—å‘',
                'é»’ã²ã‚‡ã†': 'äººå¿—å‘', 
                'ãŸã¬ã': 'äººå¿—å‘',
                'ã²ã¤ã˜': 'äººå¿—å‘',
                'ã‚ªã‚ªã‚«ãƒŸ': 'åŸå¿—å‘',
                'ã•ã‚‹': 'åŸå¿—å‘',
                'ã¨ã‚‰': 'åŸå¿—å‘',
                'ã‚³ã‚¢ãƒ©': 'åŸå¿—å‘',
                'ãƒãƒ¼ã‚¿ãƒ¼': 'å¤§ç‰©å¿—å‘',
                'ãƒ©ã‚¤ã‚ªãƒ³': 'å¤§ç‰©å¿—å‘',
                'ã‚¾ã‚¦': 'å¤§ç‰©å¿—å‘',
                'ãƒšã‚¬ã‚µã‚¹': 'å¤§ç‰©å¿—å‘',
                'æœªè¨ºæ–­': 'æœªåˆ†æ'
            };
            return orientationMap[animal] || 'æœªåˆ†æ';
        }

        function addEditableListeners() {
            // æ—¢å­˜ã®ãƒªã‚¹ãƒŠãƒ¼ã‚’å‰Šé™¤
            document.querySelectorAll('.editable').forEach(cell => {
                cell.replaceWith(cell.cloneNode(true));
            });
            
            const editableCells = document.querySelectorAll('.editable');
            
            editableCells.forEach(cell => {
                cell.addEventListener('click', function(e) {
                    if (this.classList.contains('editing')) return;
                    
                    const field = this.dataset.field;
                    const index = parseInt(this.dataset.index);
                    const currentValue = diagnosisRecords[index][field];
                    
                    // æº€è¶³åº¦ã®å ´åˆã¯â˜…ã‚’é™¤å»
                    const displayValue = field === 'satisfaction' ? currentValue.replace('â˜…', '') : currentValue;
                    
                    // ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆ
                    this.classList.add('editing');
                    const originalContent = this.innerHTML;
                    
                    // ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼å¯¾å¿œãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
                    if (field === 'gender') {
                        this.innerHTML = `
                            <select class="edit-input">
                                <option value="ç”·æ€§" ${displayValue === 'ç”·æ€§' ? 'selected' : ''}>ç”·æ€§</option>
                                <option value="å¥³æ€§" ${displayValue === 'å¥³æ€§' ? 'selected' : ''}>å¥³æ€§</option>
                                <option value="æœªè¨­å®š" ${displayValue === 'æœªè¨­å®š' ? 'selected' : ''}>æœªè¨­å®š</option>
                            </select>
                        `;
                    } else if (field === 'zodiac') {
                        const zodiacs = ['ç‰¡ç¾Šåº§', 'ç‰¡ç‰›åº§', 'åŒå­åº§', 'èŸ¹åº§', 'ç…å­åº§', 'ä¹™å¥³åº§', 'å¤©ç§¤åº§', 'è åº§', 'å°„æ‰‹åº§', 'å±±ç¾Šåº§', 'æ°´ç“¶åº§', 'é­šåº§'];
                        this.innerHTML = `
                            <select class="edit-input">
                                ${zodiacs.map(zodiac => 
                                    `<option value="${zodiac}" ${displayValue === zodiac ? 'selected' : ''}>${zodiac}</option>`
                                ).join('')}
                            </select>
                        `;
                    } else if (field === 'mbti') {
                        const mbtis = ['INTJ', 'INTP', 'ENTJ', 'ENTP', 'INFJ', 'INFP', 'ENFJ', 'ENFP', 
                                      'ISTJ', 'ISFJ', 'ESTJ', 'ESFJ', 'ISTP', 'ISFP', 'ESTP', 'ESFP', 'æœªè¨ºæ–­'];
                        this.innerHTML = `
                            <select class="edit-input">
                                ${mbtis.map(mbti => 
                                    `<option value="${mbti}" ${displayValue === mbti ? 'selected' : ''}>${mbti}</option>`
                                ).join('')}
                            </select>
                        `;
                    } else if (field === 'mainTaiheki' || field === 'subTaiheki') {
                        const taihekis = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'æœªè¨ºæ–­'];
                        this.innerHTML = `
                            <select class="edit-input">
                                ${taihekis.map(taiheki => 
                                    `<option value="${taiheki}" ${displayValue === taiheki ? 'selected' : ''}>${taiheki}</option>`
                                ).join('')}
                            </select>
                        `;
                    } else if (field === 'animal') {
                        const animals = ['ã‚ªã‚ªã‚«ãƒŸ', 'ã“ã˜ã‹', 'ã•ã‚‹', 'ãƒãƒ¼ã‚¿ãƒ¼', 'é»’ã²ã‚‡ã†', 'ãƒ©ã‚¤ã‚ªãƒ³', 'ã¨ã‚‰', 'ãŸã¬ã', 'ã‚³ã‚¢ãƒ©', 'ã‚¾ã‚¦', 'ã²ã¤ã˜', 'ãƒšã‚¬ã‚µã‚¹', 'æœªè¨ºæ–­'];
                        this.innerHTML = `
                            <select class="edit-input">
                                ${animals.map(animal => 
                                    `<option value="${animal}" ${displayValue === animal ? 'selected' : ''}>${animal}</option>`
                                ).join('')}
                            </select>
                        `;
                    } else if (field === 'theme') {
                        // ã‚¿ã‚°å…¥åŠ›å¯¾å¿œ
                        const plainValue = currentValue.replace(/<[^>]*>/g, ''); // HTMLã‚¿ã‚°ã‚’é™¤å»
                        this.innerHTML = `
                            <div class="tag-input-container">
                                <input type="text" class="tag-input" value="${plainValue}" placeholder="ã‚¿ã‚°ã‚’ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§å…¥åŠ›ï¼ˆä¾‹: è»¢è·,ã‚­ãƒ£ãƒªã‚¢,æ‚©ã¿ï¼‰" />
                                <div class="tag-help">Enterã§ä¿å­˜ã€ã‚«ãƒ³ãƒåŒºåˆ‡ã‚Šã§è¤‡æ•°ã‚¿ã‚°</div>
                            </div>
                        `;
                    } else if (field === 'satisfaction') {
                        this.innerHTML = `
                            <select class="edit-input">
                                <option value="1" ${displayValue === '1' ? 'selected' : ''}>1â˜…</option>
                                <option value="2" ${displayValue === '2' ? 'selected' : ''}>2â˜…</option>
                                <option value="3" ${displayValue === '3' ? 'selected' : ''}>3â˜…</option>
                                <option value="4" ${displayValue === '4' ? 'selected' : ''}>4â˜…</option>
                                <option value="5" ${displayValue === '5' ? 'selected' : ''}>5â˜…</option>
                                <option value="æœªè©•ä¾¡" ${displayValue === 'æœªè©•ä¾¡' ? 'selected' : ''}>æœªè©•ä¾¡</option>
                            </select>
                        `;
                    } else {
                        // é€šå¸¸ã®ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›
                        this.innerHTML = `<input type="text" class="edit-input" value="${displayValue}" />`;
                    }
                    
                    const input = this.querySelector('.edit-input');
                    input.focus();
                    if (input.type === 'text') input.select();
                    
                    // ä¿å­˜å‡¦ç†
                    function saveEdit(newValue) {
                        diagnosisRecords[index][field] = field === 'satisfaction' && newValue !== 'æœªè©•ä¾¡' ? newValue : newValue;
                        
                        // å‹•ç‰©å ã„ãŒå¤‰æ›´ã•ã‚ŒãŸå ´åˆã€å¿—å‘ã‚‚è‡ªå‹•æ›´æ–°
                        if (field === 'animal') {
                            const newOrientation = getOrientationFromAnimal(newValue);
                            diagnosisRecords[index].orientation = newOrientation;
                            
                            // å¿—å‘åˆ—ã‚‚æ›´æ–°ï¼ˆåŒã˜è¡Œã®å¿—å‘ã‚»ãƒ«ã‚’ç‰¹å®šï¼‰
                            const row = cell.parentNode;
                            const orientationCell = row.cells[8]; // å¿—å‘ã¯9ç•ªç›®ã®åˆ—ï¼ˆ0å§‹ã¾ã‚Šï¼‰
                            if (orientationCell) {
                                orientationCell.textContent = newOrientation;
                            }
                        }
                        
                        cell.classList.remove('editing');
                        
                        // è¡¨ç¤ºã‚’æ›´æ–°
                        if (field === 'satisfaction' && newValue !== 'æœªè©•ä¾¡') {
                            cell.innerHTML = newValue + 'â˜…';
                        } else if (field === 'theme') {
                            cell.innerHTML = displayTags(newValue);
                        } else {
                            cell.innerHTML = newValue;
                        }
                        
                        // çµ±è¨ˆã‚‚æ›´æ–°
                        if (document.getElementById('stats').classList.contains('active')) {
                            setTimeout(updateStatsView, 200);
                        }
                        
                        // ä¿å­˜æˆåŠŸã®è¦–è¦šãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
                        cell.style.backgroundColor = '#d4edda';
                        setTimeout(() => {
                            cell.style.backgroundColor = '';
                        }, 1000);
                    }
                    
                    // ã‚­ãƒ£ãƒ³ã‚»ãƒ«å‡¦ç†
                    function cancelEdit() {
                        cell.classList.remove('editing');
                        cell.innerHTML = originalContent;
                    }
                    
                    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
                    input.addEventListener('blur', function() {
                        saveEdit(this.value);
                    });
                    
                    input.addEventListener('keydown', function(e) {
                        if (e.key === 'Enter') {
                            e.preventDefault(); // ãƒ•ã‚©ãƒ¼ãƒ ã®é€ä¿¡ã‚’é˜²ã
                            saveEdit(this.value);
                        } else if (e.key === 'Escape') {
                            cancelEdit();
                        }
                    });
                    
                    // ã‚¿ã‚°å…¥åŠ›ã®å ´åˆã¯è¿½åŠ ã®ãƒ˜ãƒ«ãƒ—
                    if (field === 'theme') {
                        input.addEventListener('input', function() {
                            const tags = this.value.split(',').map(tag => tag.trim()).filter(tag => tag);
                            const helpDiv = this.nextElementSibling;
                            if (helpDiv && tags.length > 0) {
                                helpDiv.textContent = `ã‚¿ã‚°æ•°: ${tags.length}å€‹ - ${tags.slice(0, 3).join(', ')}${tags.length > 3 ? '...' : ''}`;
                            }
                        });
                    }
                });
                
                // ãƒ›ãƒãƒ¼æ™‚ã®ãƒ˜ãƒ«ãƒ—ãƒ†ã‚­ã‚¹ãƒˆ
                cell.addEventListener('mouseenter', function() {
                    if (!this.classList.contains('editing')) {
                        this.innerHTML += '<span class="edit-indicator">âœ</span>';
                    }
                });
                
                cell.addEventListener('mouseleave', function() {
                    const indicator = this.querySelector('.edit-indicator');
                    if (indicator) indicator.remove();
                });
            });
        }

        function addNewRecord() {
            const newId = Math.max(...diagnosisRecords.map(r => r.id)) + 1;
            const newRecord = {
                id: newId,
                date: new Date().toLocaleDateString('ja-JP', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit'
                }).replace(/\//g, '-'),
                name: "æ–°è¦ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ",
                birthDate: "1990/01/01",
                age: 34,
                gender: "æœªè¨­å®š",
                zodiac: "å±±ç¾Šåº§",
                animal: "æœªè¨ºæ–­",
                orientation: "æœªåˆ†æ",
                color: "",
                mbti: "æœªè¨ºæ–­",
                mainTaiheki: "æœªè¨ºæ–­",
                subTaiheki: "æœªè¨ºæ–­",
                sixStar: "æœªè¨ºæ–­",
                theme: "æ–°è¦ç›¸è«‡",
                advice: "æœªè¨­å®š",
                satisfaction: "æœªè©•ä¾¡",
                duration: "æœªè¨ˆæ¸¬",
                feedback: "æœªå…¥åŠ›",
                reportUrl: "",
                interviewScheduled: "",
                interviewDone: "",
                memo: "æ–°è¦è¿½åŠ ãƒ¬ã‚³ãƒ¼ãƒ‰ - ç·¨é›†ãŒå¿…è¦"
            };
            
            diagnosisRecords.push(newRecord);
            updateRecordsTable();
            
            // ç·¨é›†ãƒªã‚¹ãƒŠãƒ¼ã‚’å†è¿½åŠ 
            setTimeout(() => {
                addEditableListeners();
                
                // æ–°ã—ãè¿½åŠ ã•ã‚ŒãŸè¡Œã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
                const rows = document.querySelectorAll('#recordsBody tr');
                const newRow = rows[rows.length - 1];
                if (newRow) {
                    newRow.style.backgroundColor = '#ffe6cc';
                    newRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    
                    // 5ç§’å¾Œã«ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’è§£é™¤
                    setTimeout(() => {
                        newRow.style.backgroundColor = '';
                    }, 5000);
                }
            }, 100);
            
            alert(`âœ… æ–°ã—ã„è¨ºæ–­è¨˜éŒ²ï¼ˆID: ${newId}ï¼‰ã‚’è¿½åŠ ã—ã¾ã—ãŸï¼\n\nğŸ“ ç·¨é›†æ–¹æ³•ï¼š\nãƒ»å„ã‚»ãƒ«ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ç·¨é›†ã§ãã¾ã™\nãƒ»Enterã‚­ãƒ¼ã§ä¿å­˜ã€Escã‚­ãƒ¼ã§ã‚­ãƒ£ãƒ³ã‚»ãƒ«\nãƒ»æ˜Ÿåº§ãƒ»MBTIãƒ»ä½“ç™–ç­‰ã¯ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼è¡¨ç¤º\nãƒ»ğŸ¯ å¿—å‘ã¯å‹•ç‰©å ã„ã‹ã‚‰è‡ªå‹•æ±ºå®šã•ã‚Œã¾ã™\nãƒ»ğŸ·ï¸ ç›¸è«‡ãƒ†ãƒ¼ãƒã¯ã‚¿ã‚°å½¢å¼ï¼ˆä¾‹: è»¢è·,ã‚­ãƒ£ãƒªã‚¢,æ‚©ã¿ï¼‰\nãƒ»ğŸ“š ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚¿ãƒ–ã§å‚ç…§æƒ…å ±ã‚‚ç¢ºèªå¯èƒ½\n\nğŸ’¾ ç·¨é›†å¾Œã¯Excelå‡ºåŠ›ã§ä¿å­˜ã™ã‚‹ã“ã¨ã‚’ãŠå¿˜ã‚Œãªãï¼`);
        }

        // åˆæœŸè¡¨ç¤º
        document.addEventListener('DOMContentLoaded', function() {
            updateRecordsTable();
            updateMasterData(); // ãƒã‚¹ã‚¿ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚‚åˆæœŸåŒ–
            // å°‘ã—é…å»¶ã—ã¦ã‹ã‚‰ç·¨é›†ãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ ï¼ˆDOMãŒå®Œå…¨ã«æ§‹ç¯‰ã•ã‚Œã¦ã‹ã‚‰ï¼‰
            setTimeout(() => {
                addEditableListeners();
            }, 100);
        });
    </script>
</body>
</html>