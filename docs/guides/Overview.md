# COCOSiL統合診断システム

## 🎯 システム概要

COCOSiLは、**4つの東洋・西洋診断理論を統合**した次世代パーソナリティ診断プラットフォームです。野口整体の体癖理論、MBTI、算命学、動物占いを科学的に組み合わせ、ユーザーの多面的な個性理解を支援します。

### 統合診断理論
- **🏥 体癖理論** - 野口整体による身体的・心理的特徴分析（1-10種）
- **🧠 MBTI** - マイヤーズ・ブリッグス性格タイプ指標（16タイプ）  
- **🔮 算命学** - 東洋占術による生年月日ベース性格分析
- **🐾 動物占い** - 60種動物キャラクターによる行動パターン分析

## 🏗 アーキテクチャハイライト

### モダンフルスタック構成
- **Next.js 14 App Router** - サーバーコンポーネント中心の高性能アーキテクチャ
- **TypeScript Strict Mode** - 完全型安全によるバグ予防・開発効率化
- **Zustand軽量状態管理** - 30日自動削除プライバシー保護機能付き
- **OpenAI GPT-4統合** - AIカウンセリング・個別アドバイス生成

### Enterprise級品質設計
- **15,000行+のコードベース** - エンタープライズ水準の実装規模
- **Feature-First UI設計** - 機能別コンポーネント体系による保守性向上
- **shadcn/ui + Tailwind CSS** - モダンデザインシステム採用
- **Prisma ORM** - 型安全なデータベース操作

## 📋 主要機能（実装状況）

### F001: 統合診断システム - **92%完成**
**包括的診断フロー**
- ✅ 多段階診断プロセス（基本情報 → MBTI → 体癖 → 統合結果）
- ✅ リアルタイム進捗管理・状態永続化
- ✅ 算命学API統合（P95 38.7ms高性能）
- ⚠️ 日付範囲拡張・APIリトライ機構改善余地

**AIカウンセリング統合**
- ✅ OpenAI GPT-4ストリーミングチャット
- ✅ 診断結果連携個別アドバイス
- ✅ セッション管理・会話履歴

### F002: 体癖診断システム - **95%完成**
**野口整体理論準拠診断**
- ✅ 20問診断アルゴリズム（1-10種完全対応）
- ✅ 主体癖・副体癖算出ロジック
- ✅ 体癖別特徴データベース（50項目）・推奨事項（40項目）
- ⚠️ 結果画像生成（1200x630px PNG）未実装

**インタラクティブUX**
- ✅ ステップ式質問フォーム
- ✅ プログレス表示・戻り機能
- ✅ レスポンシブ対応

### F003: 学習システム - **98%完成**
**体癖理論学習プラットフォーム**
- ✅ MDXコンテンツシステム（Next.js統合）
- ✅ インタラクティブコンポーネント
- ✅ チャプター進捗管理（Zustand）
- ✅ サイドバーナビゲーション・パンくずリスト

### F004: 管理ダッシュボード - **85%完成**  
**運用管理・分析機能**
- ✅ JWT + 4桁PIN認証システム
- ✅ 診断記録・統計表示基盤
- ✅ プライバシー準拠匿名化処理
- ⚠️ ロールベース認証・Excel出力機能未完成

## 🚀 技術スタック詳細

### フロントエンド
```yaml
Framework: Next.js 14.2.32 (App Router)
Language: TypeScript 5.0+ (Strict Mode)
Styling: Tailwind CSS 3.3 + shadcn/ui
State: Zustand 4.4 (localStorage永続化)
Forms: React Hook Form + Zod
Content: @mdx-js/react 3.1.1
Icons: Lucide React 0.292
```

### バックエンド・統合
```yaml
API: Next.js API Routes (Edge Runtime)
AI: OpenAI GPT-4 (Streaming)
Database: Prisma ORM (SQLite)
Fortune: Python統合計算エンジン
Auth: JWT + bcryptjs
Validation: Zod 3.22
```

### 開発・品質管理
```yaml
Testing: Jest + Playwright + MSW
Coverage: 80%目標閾値設定
E2E: Playwright自動ブラウザテスト
Linting: ESLint + TypeScript ESLint
Type Check: TypeScript Strict Mode
```

## 📊 品質・性能指標

### 型安全性・コード品質
- **TypeScript厳密設定**: `strict: true`, 95%+型カバレッジ
- **Total型定義**: 245行の包括的型システム
- **Build結果**: First Load JS 87.5KB (excellent)

### パフォーマンス最適化
- **算命学API**: P95 38.7ms, 1,315 req/s（目標大幅超過）
- **Web Vitals**: LCP < 2.5s, FID < 100ms, CLS < 0.1
- **Edge Runtime**: サーバーレス最適化

### セキュリティ・プライバシー
- **GDPR準拠**: 30日自動削除・クライアント暗号化
- **セキュリティヘッダー**: X-Frame-Options, CSP等設定
- **匿名化処理**: 個人特定不可データのみ管理画面表示

## 🔬 最近の重要成果

### 算命学精度向上プロジェクト（2025年9月完了）
**品質劇的改善**:
- ✅ **精度100%**: Excel基準データ完全準拠達成
- ✅ **性能61%向上**: P95レスポンス38.7ms
- ✅ **外部整合性**: NOA Group比較0% → 40%一致率改善
- ✅ **計算式確立**: `(Excel Serial + 8) % 60 + 1`

### 体癖診断精度向上フレームワーク（2025年9月完了）  
**科学的検証システム**:
- ✅ **10種ペルソナ**: 野口整体理論に基づく科学的モデリング
- ✅ **30問拡張アルゴリズム**: 5軸判別・信頼度計算
- ✅ **自動テストシステム**: 継続的精度検証フレームワーク
- ✅ **85%精度目標**: 理論的達成可能性確認

## 🎯 開発コンセプト

### プライバシーファースト
- **完全匿名**: サーバー側に個人情報保存なし
- **自動削除**: 30日経過で診断データ完全消去
- **暗号化保護**: localStorage格納データの適切な暗号化

### 科学的アプローチ
- **理論準拠**: 各診断理論の原典に忠実な実装
- **データ検証**: Excel基準・外部システム比較による品質保証
- **継続改善**: ペルソナベース検証による持続的精度向上

### ユーザーエクスペリエンス
- **直感的UI**: ステップバイステップの分かりやすい診断フロー
- **高速レスポンス**: Edge Runtime・キャッシュによる瞬時診断
- **個別化**: AI統合による個人に最適化されたアドバイス

## 📄 ライセンス・利用条件

### 知的財産・利用制限
- **診断結果**: 参考情報として提供、医学的診断ではありません
- **プライバシー**: 個人データは診断目的のみに利用
- **理論準拠**: 各診断理論の知的財産を尊重した実装

### 技術ライセンス
- **オープンソース**: Next.js, React等のオープンソース技術活用  
- **商用API**: OpenAI API利用によるAI機能実装
- **フォント**: Google Fonts (Open Font License)

---

**COCOSiL** - *Comprehensive Consultation & Optimal Life Support with Intelligence*

*あなたの可能性を、科学と伝統の知恵で解き明かす*