# システム要件定義書

## システム概要

**COCOSiL（ココシル）分析システム**は、体癖理論・MBTI・動物占い・算命学を統合した包括的な人間理解プラットフォームです。検証段階として、テストユーザーから基本情報を収集し、管理者がClaude AIとの対話に活用できるプロンプト生成機能を提供します。4つの専門サイトが相互連携し、ユーザーの包括的な分析を可能にし、個人データの厳格な管理のもと、新しい診断手法の検証と改善を目指します。

### 1. システムの目的
- **検証フェーズでのデータ収集**：テストユーザーの基本情報を体系的に収集し、分析精度の向上を図る
- **Claude AI活用の最適化**：収集したデータを基に管理者向けの最適なプロンプト生成を行う
- **統合診断システムの構築**：体癖・MBTI・動物占い・算命学の知見を統合した新しい診断手法の確立
- **ユーザー体験の向上**：専門知識を学習しながら自己理解を深められる教育的プラットフォームの提供

### 2. 主な機能
**コア機能（3-5個）**
- **統合データ収集システム**：多段階フォームによる包括的な個人情報収集
- **体癖診断エンジン**：20問形式による精密な体癖判定システム
- **Claude AI連携機能**：収集データを基にした管理者向けプロンプト自動生成
- **サイト間連携システム**：4つの専門サイト間のシームレスな情報共有

**差別化機能（2-3個）**
- **複合診断アルゴリズム**：複数の診断手法を統合した独自の分析ロジック
- **学習支援システム**：体癖論等の専門知識を段階的に学習できる教育機能
- **プライバシー保護機能**：個人データの厳格な管理と他診断への非活用保証

**付加価値機能（1-2個）**
- **管理者向けダッシュボード**：診断データの統計分析と傾向把握機能
- **結果可視化システム**：診断結果の画像生成・ダウンロード機能

### 3. 提供する価値
**ユーザーにとっての直接的価値**
- 複数の診断手法を統合した包括的な自己理解の機会
- 専門的な体癖論の学習と実践的診断体験
- 個人データが他の目的に使用されない安心感

**ビジネスにとっての価値**
- 統合診断手法の検証とデータ蓄積
- Claude AI活用の最適化とプロンプト改善
- 将来的なサービス展開のための基盤構築

**社会的価値**
- 東洋の伝統的知識（体癖論・算命学）のデジタル化と現代への応用
- 個人理解の新しい手法の確立と普及

### 4. 実現方法の概要
**主要なテクノロジー要素**
- **フロントエンド**：HTML5/CSS3/JavaScript（ES6+）による responsive design
- **データ管理**：ローカルストレージとセッション管理による一時的データ保持
- **連携システム**：URLパラメータとlocalStorageを活用したサイト間データ共有
- **セキュリティ**：クライアントサイド暗号化と最小限のデータ保持

**重要なインテグレーションポイント**
- 4サイト間のシームレスなナビゲーション
- 診断データの統合表示システム
- Claude AI向けプロンプト生成API

**スケーラビリティへの考慮**
- 静的サイト構成による軽量化
- CDN活用によるグローバル配信対応
- モジュラー設計による機能拡張性

## 情報の前提と仮定

### 分析に使用した情報源
- **既存サイト分析**：References/内の4つのHTMLファイル
  - `taiheki_diagnosis_improved.html`：体癖診断システム
  - `taiheki_theory_website.html`：体癖論入門サイト
  - `cocoseal_mockup.html`：ココシルAIチャット
  - `fortune_database.html`：占い師診断データベース

### 置いた仮定
- **検証期間**：6ヶ月程度のテストフェーズを想定
- **テストユーザー規模**：50-100人程度の限定ユーザーでの検証
- **技術スタック**：Pure JavaScript（フレームワーク非依存）での実装
- **データ保持期間**：個人識別情報は診断完了後に削除、統計データのみ匿名化して保持
- **アクセス環境**：モダンブラウザ（Chrome/Safari/Edge/Firefox）での利用

## 機能要件

### F001: ユーザー向け統合システム（ココシル入口サイト）
- **F001-1**：基本情報入力フォーム（名前・生年月日・既知の診断結果）
- **F001-2**：プログレッシブ情報収集（段階的な詳細情報の取得）
- **F001-3**：他サイトへの適切なルーティング機能
- **F001-4**：セッション管理とデータ一時保存

### F002: 体癖診断システム
- **F002-1**：20問形式の体癖診断フロー
- **F002-2**：主体癖・副体癖の算出アルゴリズム
- **F002-3**：診断結果の詳細表示（特徴・行動パターン・適職等）
- **F002-4**：結果画像の生成・ダウンロード機能

### F003: 体癖論学習サイト
- **F003-1**：体癖論の基本理論解説
- **F003-2**：10種体癖の詳細解説
- **F003-3**：インタラクティブな学習コンテンツ
- **F003-4**：診断サイトへの導線

### F004: 管理者向けデータベースシステム
- **F004-1**：診断記録の一元管理
- **F004-2**：統計分析ダッシュボード
- **F004-3**：Excel形式でのデータエクスポート
- **F004-4**：Claude AIプロンプト生成機能

### F005: サイト間連携システム
- **F005-1**：統一されたナビゲーション
- **F005-2**：データの引き継ぎ機能
- **F005-3**：診断進捗の可視化
- **F005-4**：結果の統合表示

## 非機能要件

### パフォーマンス要件
- **応答時間**：主要画面の表示は3秒以内（初期ユーザー50-100人規模想定）
- **スループット**：同時アクセス20人まで対応
- **ファイルサイズ**：各ページの初期ロードは2MB以内

### セキュリティ要件
- **データ保護**：個人識別情報のクライアントサイド暗号化
- **プライバシー**：診断データの他目的利用禁止の徹底
- **アクセス制御**：管理者向けデータベースの厳格なアクセス制限
- **データ削除**：ユーザー要求に基づく即座のデータ削除機能

### 可用性・信頼性
- **稼働率**：99%以上（検証期間中）
- **バックアップ**：日次の自動バックアップ
- **復旧時間**：障害発生時4時間以内の復旧

### ユーザビリティ
- **レスポンシブ対応**：スマートフォン・タブレット・PC全対応
- **アクセシビリティ**：WCAG 2.1 AA準拠
- **多言語対応**：日本語のみ（初期段階）

### 拡張性・保守性
- **モジュラー設計**：機能単位での独立した実装
- **バージョン管理**：Git管理による変更履歴保持
- **ドキュメント**：コード・API・運用手順の文書化

## 技術スタック

### フロントエンド技術
**選定技術**：HTML5/CSS3/Vanilla JavaScript
**選定理由**：
- **軽量性**：フレームワーク依存がなく、高速な動作を実現
- **保守性**：Pure JavaScriptによる長期的な技術的安定性
- **学習コスト**：標準技術のため、メンテナンス人材の確保が容易
- **ブラウザ互換性**：モダンブラウザでの幅広い対応

### スタイリング
**選定技術**：CSS3 + CSS Grid/Flexbox
**選定理由**：
- **デザイン柔軟性**：グラデーション・アニメーション等のモダンUI実現
- **レスポンシブ対応**：Grid/Flexboxによる効率的なレイアウト
- **パフォーマンス**：CSS-in-JSより軽量で高速な描画

### データ管理
**選定技術**：localStorage + sessionStorage
**選定理由**：
- **プライバシー保護**：サーバーサイドでの個人情報保存を回避
- **オフライン対応**：ネットワーク不安定時でも継続利用可能
- **実装簡易性**：複雑なデータベース設計が不要

### 診断ロジック
**選定技術**：JavaScript アルゴリズム実装
**選定理由**：
- **高速処理**：クライアントサイドでのリアルタイム診断
- **カスタマイズ性**：診断ロジックの柔軟な調整・改善が可能
- **セキュリティ**：診断データのサーバー送信が不要

## 開発ロードマップ

### Phase 1：基盤構築（4週間）
**Week 1-2：サイト構造設計・基本実装**
- 4サイトの基本構造とナビゲーション実装
- 統一されたデザインシステムの構築
- サイト間データ連携の基盤設計

**Week 3-4：コア機能実装**
- 基本情報収集フォームの実装
- 体癖診断アルゴリズムの実装・調整
- ローカルストレージによるデータ管理実装

**フェーズ分けの根拠**：MVPとしての最低限機能を優先し、検証に必要な基盤を早期確立

### Phase 2：診断機能拡充（3週間）
**Week 5-6：診断精度向上・UI/UX改善**
- 複合診断ロジックの実装・調整
- 結果表示画面の詳細実装
- ユーザビリティテストに基づく改善

**Week 7：統合機能実装**
- 各診断結果の統合表示機能
- Claude AIプロンプト生成機能
- 管理者向けダッシュボードの基本実装

### Phase 3：検証・最適化（3週間）
**Week 8-9：テスト・デバッグ**
- 全機能の統合テスト
- セキュリティ・プライバシー対応の検証
- パフォーマンス最適化

**Week 10：運用準備・ドキュメント整備**
- 運用手順書の作成
- ユーザーマニュアルの作成
- 検証開始準備

## リスク分析

### 技術的リスク（中程度）
**R001：診断精度の課題**
- **影響度**：中 / **発生確率**：中
- **内容**：複数の診断手法統合による精度低下
- **対策**：段階的な精度検証、専門家レビューの実施、アルゴリズム調整機能の実装

**R002：ブラウザ互換性問題**
- **影響度**：低 / **発生確率**：低
- **内容**：古いブラウザでの動作不良
- **対策**：対応ブラウザの明示、Polyfillの導入、段階的graceful degradation

### ビジネス的リスク（低-中程度）
**R003：ユーザーエンゲージメント不足**
- **影響度**：中 / **発生確率**：中
- **内容**：テストユーザーの継続利用率低下
- **対策**：ユーザーフィードバックの積極収集、UI/UX改善、インセンティブ設計

**R004：データ品質の問題**
- **影響度**：中 / **発生確率**：低
- **内容**：入力データの不正確性・不完全性
- **対策**：入力検証機能強化、ユーザー教育、データクレンジング機能

### 法的/コンプライアンスリスク（低程度）
**R005：プライバシー規制対応**
- **影響度**：高 / **発生確率**：低
- **内容**：個人情報保護法・GDPR等への対応不足
- **対策**：最小限データ保持原則の徹底、データ削除機能実装、プライバシーポリシー整備

### 運用的リスク（低程度）
**R006：メンテナンス体制不足**
- **影響度**：中 / **発生確率**：低
- **内容**：運用開始後のサポート・改善体制不備
- **対策**：運用手順書整備、問い合わせ窓口設置、定期的な改善サイクル確立

## 追加情報リクエスト

### 高優先度（システム設計に大きく影響）
1. **検証期間・スケジュール詳細**：具体的な検証開始日程・期間・マイルストーンの設定
2. **管理者権限・アクセス方法**：データベース管理者の人数・権限レベル・アクセス方法の詳細
3. **Claude AI連携仕様**：プロンプト生成の具体的な出力形式・連携方法・API仕様

### 中優先度（機能詳細に影響）
4. **テストユーザー募集・管理方法**：ユーザー管理方法・個人情報の扱い・同意取得プロセス
5. **診断結果の活用範囲**：結果データの研究利用・改善への活用方法・匿名化レベル
6. **サイト間の具体的な連携シナリオ**：ユーザージャーニーの詳細・推奨利用順序

### 低優先度（将来的な拡張に影響）
7. **検証後の展開計画**：本格運用時の機能追加・有料化計画・規模拡大予定
8. **技術スタック変更の可能性**：将来的なフレームワーク導入・データベース移行の検討
9. **外部連携の予定**：他社サービスとの連携・API公開・パートナーシップ計画