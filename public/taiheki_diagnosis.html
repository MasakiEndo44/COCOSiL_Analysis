<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä½“ç™–è¨ºæ–­ã‚·ã‚¹ãƒ†ãƒ </title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            padding: 20px 20px 40px 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 800px;
            width: 100%;
            padding: 40px;
            animation: fadeIn 0.5s ease;
            margin: 20px 0;
            align-self: flex-start;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        h1 {
            color: #333;
            font-size: 2em;
            margin-bottom: 10px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            color: #666;
            font-size: 0.95em;
        }

        .progress-container {
            background: #f0f0f0;
            height: 8px;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 10px;
            transition: width 0.3s ease;
        }

        .question-number {
            text-align: center;
            color: #666;
            margin-bottom: 20px;
            font-size: 0.9em;
        }

        .question-container {
            min-height: 400px;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .question-title {
            font-size: 1.3em;
            color: #333;
            margin-bottom: 25px;
            font-weight: 600;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .option {
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .option:hover {
            border-color: #667eea;
            background: #f8f9ff;
            transform: translateX(5px);
        }

        .option.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, rgba(102,126,234,0.1), rgba(118,75,162,0.1));
            font-weight: 600;
        }

        .scale-options {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            gap: 10px;
        }

        .scale-option {
            flex: 1;
            padding: 20px 10px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            background: white;
        }

        .scale-option:hover {
            border-color: #667eea;
            background: #f8f9ff;
            transform: translateY(-3px);
        }

        .scale-option.selected {
            border-color: #667eea;
            background: linear-gradient(135deg, rgba(102,126,234,0.2), rgba(118,75,162,0.2));
            font-weight: 600;
        }

        .scale-label {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
        }

        .scale-text {
            font-size: 0.85em;
            color: #666;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 15px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-prev {
            background: #e0e0e0;
            color: #666;
        }

        .btn-prev:hover:not(:disabled) {
            background: #d0d0d0;
        }

        .btn-next {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            flex: 1;
        }

        .btn-next:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102,126,234,0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* çµæœç”»é¢ */
        .results {
            animation: fadeIn 0.5s ease;
        }

        .result-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .result-title {
            font-size: 2em;
            color: #333;
            margin-bottom: 20px;
        }

        .main-result {
            background: linear-gradient(135deg, rgba(102,126,234,0.1), rgba(118,75,162,0.1));
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
        }

        .type-name {
            font-size: 1.8em;
            color: #667eea;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .type-description {
            color: #333;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .score-chart {
            margin-top: 30px;
        }

        .score-item {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .score-label {
            width: 100px;
            font-weight: 600;
            color: #333;
        }

        .score-bar-container {
            flex: 1;
            background: #f0f0f0;
            height: 25px;
            border-radius: 15px;
            overflow: hidden;
            margin: 0 15px;
        }

        .score-bar {
            height: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 15px;
            transition: width 1s ease;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
        }

        .score-value {
            color: white;
            font-weight: bold;
            font-size: 0.9em;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .restart-btn, .download-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 30px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
        }

        .restart-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        .download-btn {
            background: linear-gradient(135deg, #fd7e14, #ffc107);
        }

        .restart-btn:hover, .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102,126,234,0.4);
        }

        .info-btn {
            display: inline-block;
            padding: 10px 20px;
            background: linear-gradient(135deg, #17a2b8, #138496);
            color: white;
            text-decoration: none;
            border-radius: 25px;
            font-size: 0.9em;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-bottom: 20px;
            border: none;
            cursor: pointer;
        }

        .info-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(23,162,184,0.3);
            text-decoration: none;
            color: white;
        }



        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }
            
            .scale-options {
                flex-direction: column;
            }
            
            .scale-option {
                padding: 15px;
            }

            .action-buttons {
                flex-direction: column;
                align-items: center;
            }

            .restart-btn, .download-btn {
                width: 80%;
                max-width: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="app"></div>
    </div>

    <canvas id="result-canvas" style="display: none;"></canvas>

    <script>
        // ä½“ç™–ãƒ‡ãƒ¼ã‚¿å®šç¾©
        const taihekiTypes = {
            type1: { name: '1ç¨®ä½“ç™–', subtitle: 'ä¸Šä¸‹å‹ãƒ»è«–ç†çš„æ€è€ƒå‹', description: 'ç†è«–çš„ã§è«–ç†çš„ãªæ€è€ƒã‚’é‡è¦–ã€‚ç‰©äº‹ã‚’è¨€è‘‰ã§èª¬æ˜ã—ã€å–„æ‚ªã®åˆ¤æ–­ã‚’å¤§åˆ‡ã«ã—ã¾ã™ã€‚' },
            type2: { name: '2ç¨®ä½“ç™–', subtitle: 'ä¸Šä¸‹å‹ãƒ»å¿ƒé…æ€§å‹', description: 'æ…é‡ã§çœŸé¢ç›®ã€ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã‚’é‡è¦–ã€‚ä¸å®‰ã‚’æ„Ÿã˜ã‚„ã™ãã€æº–å‚™ã‚’å¤§åˆ‡ã«ã—ã¾ã™ã€‚' },
            type3: { name: '3ç¨®ä½“ç™–', subtitle: 'å·¦å³å‹ãƒ»æ„Ÿæƒ…è¡¨å‡ºå‹', description: 'æ„Ÿæƒ…è±Šã‹ã§æ˜ã‚‹ãç¤¾äº¤çš„ã€‚ç¾å‘³ã—ã„ã‚‚ã®ã‚„æ¥½ã—ã„ã“ã¨ãŒå¤§å¥½ããªãƒ ãƒ¼ãƒ‰ãƒ¡ãƒ¼ã‚«ãƒ¼ã€‚' },
            type4: { name: '4ç¨®ä½“ç™–', subtitle: 'å·¦å³å‹ãƒ»æ„Ÿæƒ…æŠ‘åˆ¶å‹', description: 'ã‚¯ãƒ¼ãƒ«ã§æ„Ÿæƒ…ã‚’æŠ‘åˆ¶ã€‚ä»–äººã®æ°—æŒã¡ã«å¯„ã‚Šæ·»ã„ã€èª¿å’Œã‚’å¤§åˆ‡ã«ã—ã¾ã™ã€‚' },
            type5: { name: '5ç¨®ä½“ç™–', subtitle: 'å‰å¾Œå‹ãƒ»è¡Œå‹•çš„åˆç†å‹', description: 'è¡Œå‹•çš„ã§åˆç†çš„ã€‚åŠ¹ç‡ã‚’é‡è¦–ã—ã€å¸¸ã«å‹•ãå›ã‚‹ã‚¨ãƒãƒ«ã‚®ãƒƒã‚·ãƒ¥ãªã‚¿ã‚¤ãƒ—ã€‚' },
            type6: { name: '6ç¨®ä½“ç™–', subtitle: 'å‰å¾Œå‹ãƒ»å†…å‘çš„ç†æƒ³å‹', description: 'ç†æƒ³å®¶ã§ãƒ­ãƒãƒ³ãƒã‚¹ãƒˆã€‚é™ã‹ã§å†…å‘çš„ã§ã™ãŒã€é«˜ã„ç†æƒ³ã‚’è¿½æ±‚ã—ã¾ã™ã€‚' },
            type7: { name: '7ç¨®ä½“ç™–', subtitle: 'æ»ã‚Œå‹ãƒ»é—˜äº‰å‹', description: 'é—˜å¿—ã«ã‚ãµã‚Œã€ç«¶äº‰å¿ƒãŒå¼·ã„ã€‚è¦ªåˆ†è‚Œã§ãƒªãƒ¼ãƒ€ãƒ¼ã‚·ãƒƒãƒ—ã‚’ç™ºæ®ã—ã¾ã™ã€‚' },
            type8: { name: '8ç¨®ä½“ç™–', subtitle: 'æ»ã‚Œå‹ãƒ»å¿è€å‹', description: 'æˆ‘æ…¢å¼·ãåœ°é“ãªåŠªåŠ›å®¶ã€‚ç¾©ç†å …ãã€ç¸ã®ä¸‹ã®åŠ›æŒã¡ã‚¿ã‚¤ãƒ—ã€‚' },
            type9: { name: '9ç¨®ä½“ç™–', subtitle: 'é–‹é–‰å‹ãƒ»é›†ä¸­å‹', description: 'å‡ã‚Šæ€§ã§å®Œç’§ä¸»ç¾©ã€‚ä¸€ã¤ã®ã“ã¨ã«é›†ä¸­ã—ã€æ·±ãæ¥µã‚ã‚‹ã“ã¨ã‚’å¥½ã¿ã¾ã™ã€‚' },
            type10: { name: '10ç¨®ä½“ç™–', subtitle: 'é–‹é–‰å‹ãƒ»åŒ…å®¹å‹', description: 'åŒ…å®¹åŠ›ãŒã‚ã‚Šä¸–è©±å¥½ãã€‚å¤§ã‚‰ã‹ã§ã€ã¿ã‚“ãªã‚’ã¾ã¨ã‚ã‚‹è¦ªåˆ†è‚Œã€‚' }
        };

        // è³ªå•ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ©ãƒ³ãƒ€ãƒ åŒ–æ¸ˆã¿ï¼‰
        const questions = [
            {
                id: 1,
                type: 'single',
                weight: 2.5,
                text: 'ã€Q1ã€‘ä½“å‹ã¨å§¿å‹¢ã«ã¤ã„ã¦æœ€ã‚‚è¿‘ã„ã‚‚ã®ã¯ï¼Ÿ',
                options: [
                    { text: 'ä¸¸ã¿ãŒã‚ã‚Šã€ãªã§è‚©ã€è‰²ç™½ã§æ›²ç·šçš„', scores: {type3: 10} },
                    { text: 'èƒ´ãŒå¤ªã„æ¨½å‹ã€ã‚¨ãƒ©ãŒå¼µã£ãŸå››è§’é¡”', scores: {type8: 10} },
                    { text: 'è‚©å¹…åºƒãVå­—å‹ã€èƒ¸ã‚’å¼µã‚‹ã€é³©èƒ¸æ°—å‘³', scores: {type5: 10} },
                    { text: 'å¤§æŸ„ã§éª¨ç›¤ãŒåºƒã„ã€é¡”ã®ãƒ‘ãƒ¼ãƒ„ãŒå¤§ãã„', scores: {type10: 10} },
                    { text: 'é¦–ãŒå¤ªããŒã£ã—ã‚Šã€å‰å‚¾å§¿å‹¢ã€å¾Œé ­éƒ¨ãŒå¹³ã‚‰', scores: {type2: 10} },
                    { text: 'å°æŸ„ã§çŒ«èƒŒæ°—å‘³ã€é¡ãŒç´°ã„ã€ä¸‰ç™½çœ¼', scores: {type6: 10} },
                    { text: 'å°æŸ„ã§éª¨ç›¤ãŒç‹­ã„ã€é ­ã®å¹…ãŒç‹­ã„ã€å‡ºã£å°»', scores: {type9: 10} },
                    { text: 'ç›´ç·šçš„ã§ã€ã„ã‹ã‚Šè‚©ã€ç—©ã›å‹ã§èƒ¸æ¿ãŒè–„ã„', scores: {type4: 10} },
                    { text: 'ç´°é•·ãå‰ã‹ãŒã¿ã€é¦–ãŒé•·ã„ã€ãŠã§ã“ãŒåºƒã„', scores: {type1: 10} },
                    { text: 'ç­‹è‚‰è³ªã§ãŒã£ã¡ã‚Šã€å£°ãŒå¤§ããéŸ¿ã', scores: {type7: 10} }
                ]
            },
            {
                id: 2,
                type: 'single',
                weight: 2.0,
                text: 'ã€Q2ã€‘ç‰©äº‹ã‚’åˆ¤æ–­ã™ã‚‹æ™‚ã€æœ€ã‚‚å„ªå…ˆã™ã‚‹åŸºæº–ã¯ï¼Ÿ',
                options: [
                    { text: 'æ¥½ã—ã„ã‹æ¥½ã—ããªã„ã‹ã€å¥½ãã‹å«Œã„ã‹', scores: {type3: 8} },
                    { text: 'æ­£ç¾©ã«é©ã†ã‹ã€å¼±è€…ã‚’å®ˆã‚Œã‚‹ã‹', scores: {type8: 8} },
                    { text: 'åŠ¹ç‡çš„ã‹ã€ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚‹ã‹', scores: {type5: 8} },
                    { text: 'ã¿ã‚“ãªãŒå¹¸ã›ã«ãªã‚Œã‚‹ã‹ã€åŒ…ã¿è¾¼ã‚ã‚‹ã‹', scores: {type10: 8} },
                    { text: 'å®‰å…¨ã‹å±é™ºã‹ã€ãƒªã‚¹ã‚¯ã¯ãªã„ã‹', scores: {type2: 8} },
                    { text: 'ç†æƒ³ã«è¿‘ã„ã‹ã€ç¾ã—ã„ã‹', scores: {type6: 8} },
                    { text: 'å®Œç’§ã‹ã€ç´å¾—ã§ãã‚‹ã¾ã§çªãè©°ã‚ã‚‰ã‚Œã‚‹ã‹', scores: {type9: 8} },
                    { text: 'å‘¨ã‚ŠãŒä¸å¿«ã«æ€ã‚ãªã„ã‹ã€èª¿å’ŒãŒä¿ã¦ã‚‹ã‹', scores: {type4: 8} },
                    { text: 'è«–ç†çš„ã«æ­£ã—ã„ã‹ã€ç­‹ãŒé€šã£ã¦ã„ã‚‹ã‹', scores: {type1: 8} },
                    { text: 'å‹ã¦ã‚‹ã‹è² ã‘ã‚‹ã‹ã€å„ªä½ã«ç«‹ã¦ã‚‹ã‹', scores: {type7: 8} }
                ]
            },
            {
                id: 3,
                type: 'single',
                weight: 1.5,
                text: 'ã€Q3ã€‘ã‚¹ãƒˆãƒ¬ã‚¹ã‚’æ„Ÿã˜ãŸæ™‚ã€æœ€ã‚‚åŠ¹æœçš„ãªç™ºæ•£æ–¹æ³•ã¯ï¼Ÿ',
                options: [
                    { text: 'ç¾å‘³ã—ã„ã‚‚ã®ã‚’æ€ã„ã£ãã‚Šé£Ÿã¹ã¦å¿˜ã‚Œã‚‹', scores: {type3: 6} },
                    { text: 'ã‚³ãƒ„ã‚³ãƒ„ã¨ä½œæ¥­ã«æ²¡é ­ã—ã€åœ°é“ã«è§£æ¶ˆã™ã‚‹', scores: {type8: 6} },
                    { text: 'ä½“ã‚’å‹•ã‹ã—ãŸã‚Šè²·ã„ç‰©ã§æ°—åˆ†è»¢æ›ã™ã‚‹', scores: {type5: 6} },
                    { text: 'äººã®ä¸–è©±ã‚’ç„¼ã„ã¦ã€è‡ªåˆ†ã‚’å¿˜ã‚Œã‚‹', scores: {type10: 6} },
                    { text: 'ä¿¡é ¼ã§ãã‚‹äººã«ä¸å®‰ã‚’èã„ã¦ã‚‚ã‚‰ã„å®‰å¿ƒã™ã‚‹', scores: {type2: 6} },
                    { text: 'éæ—¥å¸¸çš„ãªå ´æ‰€ã«è¡Œãã€ç¾å®Ÿã‹ã‚‰é›¢ã‚Œã‚‹', scores: {type6: 6} },
                    { text: 'å¥½ããªã“ã¨ã‚’å¾¹åº•çš„ã«æ¥µã‚ã¦é›†ä¸­ã™ã‚‹', scores: {type9: 6} },
                    { text: 'ä¸€äººã§é™ã‹ã«éã”ã—ã€å¿ƒã‚’è½ã¡ç€ã‘ã‚‹', scores: {type4: 6} },
                    { text: 'åŸå› ã‚’è«–ç†çš„ã«åˆ†æã—ã€è¨€èªåŒ–ã—ã¦æ•´ç†ã™ã‚‹', scores: {type1: 6} },
                    { text: 'ç«¶äº‰ã‚„å‹è² äº‹ã§é—˜äº‰å¿ƒã‚’ç™ºæ•£ã™ã‚‹', scores: {type7: 6} }
                ]
            },
            {
                id: 4,
                type: 'scale',
                weight: 1.5,
                text: 'ã€Q4ã€‘ã€Œä½•äº‹ã‚‚ç†å±ˆã§è€ƒãˆã¦ã‹ã‚‰åˆ¤æ–­ã™ã‚‹ã€',
                scaleOptions: [
                    { value: 5, scores: {type1: 8} },
                    { value: 4, scores: {type1: 5, type2: 2} },
                    { value: 3, scores: {type2: 1, type4: 1} },
                    { value: 2, scores: {type3: 3, type5: 2} },
                    { value: 1, scores: {type3: 6, type7: 4} }
                ]
            },
            {
                id: 5,
                type: 'scale',
                weight: 1.2,
                text: 'ã€Q5ã€‘ã€Œã˜ã£ã¨ã—ã¦ã„ã‚‹ã‚ˆã‚Šã€å¸¸ã«å‹•ã„ã¦ã„ãŸã„ã€',
                scaleOptions: [
                    { value: 5, scores: {type5: 6, type7: 5, type3: 3} },
                    { value: 4, scores: {type5: 4, type7: 3, type3: 2} },
                    { value: 3, scores: {type1: 1, type10: 1} },
                    { value: 2, scores: {type2: 2, type4: 2, type8: 1} },
                    { value: 1, scores: {type6: 5, type9: 4, type4: 3} }
                ]
            },
            {
                id: 6,
                type: 'single',
                weight: 1.0,
                text: 'ã€Q6ã€‘é£Ÿäº‹ã«ã¤ã„ã¦æœ€ã‚‚å½“ã¦ã¯ã¾ã‚‹ã®ã¯ï¼Ÿ',
                options: [
                    { text: 'ç¾å‘³ã—ã„ã‚‚ã®ã‚’é£Ÿã¹ã‚‹ã“ã¨ãŒæœ€é«˜ã®å¹¸ã›', scores: {type3: 4} },
                    { text: 'ã‚ˆãå™›ã‚“ã§ã‚†ã£ãã‚Šã€æ¶ˆåŒ–ã‚’æ„è­˜', scores: {type8: 4} },
                    { text: 'é£Ÿã¹ãªãŒã‚‰ä»–ã®ã“ã¨ã‚‚åŒæ™‚ã«ã™ã‚‹', scores: {type5: 4} },
                    { text: 'ã¿ã‚“ãªã§ãƒ¯ã‚¤ãƒ¯ã‚¤é£Ÿäº‹ã™ã‚‹ã®ãŒæ¥½ã—ã„', scores: {type10: 4} },
                    { text: 'æ±ºã¾ã£ãŸæ™‚é–“ã«è¦å‰‡æ­£ã—ãé£Ÿã¹ãªã„ã¨ä¸å®‰', scores: {type2: 4} },
                    { text: 'ä¸€äººã§é™ã‹ã«ã€è‡ªåˆ†ã®ãƒšãƒ¼ã‚¹ã§é£Ÿã¹ãŸã„', scores: {type6: 4} },
                    { text: 'å¥½ããªã‚‚ã®ã‚’ä½•åº¦ã‚‚ç¹°ã‚Šè¿”ã—é£Ÿã¹ã‚‹', scores: {type9: 4} },
                    { text: 'å°‘ã—ãšã¤ã¤ã¾ã‚€ç¨‹åº¦ã€é£Ÿã«åŸ·ç€ãŒãªã„', scores: {type4: 4} },
                    { text: 'è€ƒãˆäº‹ã‚’ã—ã¦ã„ã¦é£Ÿäº‹ã‚’å¿˜ã‚Œã‚‹ã“ã¨ãŒå¤šã„', scores: {type1: 4, type9: 2} },
                    { text: 'è±ªå¿«ã«ã‚¬ãƒ„ã‚¬ãƒ„ã€æ—©é£Ÿã„å‚¾å‘', scores: {type7: 4} }
                ]
            },
            {
                id: 7,
                type: 'scale',
                weight: 1.2,
                text: 'ã€Q7ã€‘ã€ŒåŒã˜ä½œæ¥­ã‚’é•·æ™‚é–“ç¶šã‘ã‚‹ã“ã¨ãŒã§ãã‚‹ã€',
                scaleOptions: [
                    { value: 5, scores: {type9: 8, type8: 5} },
                    { value: 4, scores: {type9: 5, type8: 3, type2: 2} },
                    { value: 3, scores: {type1: 1, type10: 1} },
                    { value: 2, scores: {type3: 3, type5: 3, type7: 2} },
                    { value: 1, scores: {type3: 5, type5: 5, type6: 3} }
                ]
            },
            {
                id: 8,
                type: 'single',
                weight: 2.0,
                text: 'ã€Q8ã€‘ã‚°ãƒ«ãƒ¼ãƒ—ã§ã®è‡ªç„¶ãªå½¹å‰²ã¯ï¼Ÿ',
                options: [
                    { text: 'å ´ã‚’æ˜ã‚‹ãã—ã€æ¥½ã—ã„é›°å›²æ°—ã‚’ä½œã‚‹ç››ã‚Šä¸Šã’å½¹', scores: {type3: 8} },
                    { text: 'é™°ã§æ”¯ãˆã‚‹ã€ç¸ã®ä¸‹ã®åŠ›æŒã¡', scores: {type8: 8} },
                    { text: 'å³æ–­å³æ±ºã§å¼•ã£å¼µã‚‹ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªãƒªãƒ¼ãƒ€ãƒ¼', scores: {type5: 8} },
                    { text: 'å…¨å“¡ã‚’åŒ…ã¿è¾¼ã‚€ã€å¤§ã‚‰ã‹ãªã¾ã¨ã‚å½¹', scores: {type10: 8} },
                    { text: 'ãƒªã‚¹ã‚¯ã‚’æŒ‡æ‘˜ã—ã€æ…é‡ã«èª¿æ•´ã™ã‚‹å®‰å…¨ç®¡ç†å½¹', scores: {type2: 8} },
                    { text: 'ç‹¬è‡ªã®ç†æƒ³ã‚’è¿½æ±‚ã™ã‚‹ä¸€åŒ¹ç‹¼', scores: {type6: 8} },
                    { text: 'å°‚é–€åˆ†é‡ã‚’æ¥µã‚ã‚‹ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆ', scores: {type9: 8} },
                    { text: 'çš†ã®æ°—æŒã¡ã‚’å¯Ÿã—ã€èª¿å’Œã‚’ä¿ã¤ã‚µãƒãƒ¼ãƒˆå½¹', scores: {type4: 8} },
                    { text: 'è«–ç†çš„ãªã‚¢ã‚¤ãƒ‡ã‚¢ã‚„ç†è«–ã‚’æä¾›ã™ã‚‹é ­è„³å½¹', scores: {type1: 8} },
                    { text: 'å…ˆé ­ã«ç«‹ã£ã¦æˆ¦ã†ã€é—˜å¿—ã‚ãµã‚Œã‚‹åˆ‡ã‚Šè¾¼ã¿éšŠé•·', scores: {type7: 8} }
                ]
            },
            {
                id: 9,
                type: 'scale',
                weight: 1.3,
                text: 'ã€Q9ã€‘ã€Œæ„Ÿæƒ…ã‚’ç´ ç›´ã«è¡¨ç¾ã™ã‚‹ã»ã†ã ã€',
                scaleOptions: [
                    { value: 5, scores: {type3: 7, type7: 4} },
                    { value: 4, scores: {type3: 5, type5: 2, type10: 2} },
                    { value: 3, scores: {type1: 1} },
                    { value: 2, scores: {type2: 2, type4: 3, type8: 2} },
                    { value: 1, scores: {type4: 6, type6: 5, type9: 4} }
                ]
            },
            {
                id: 10,
                type: 'single',
                weight: 1.5,
                text: 'ã€Q10ã€‘ä»•äº‹ã‚„å‹‰å¼·ã®å–ã‚Šçµ„ã¿æ–¹ã¯ï¼Ÿ',
                options: [
                    { text: 'æ¥½ã—ãã†ãªã‚‰æ·±ãè€ƒãˆãšã«ã™ãå§‹ã‚ã‚‹', scores: {type3: 6} },
                    { text: 'åœ°é“ã«ã‚³ãƒ„ã‚³ãƒ„ã€ä¸€æ­©ãšã¤ç¢ºå®Ÿã«é€²ã‚ã‚‹', scores: {type8: 6} },
                    { text: 'è€ƒãˆã‚‹ã‚ˆã‚Šå…ˆã«ä½“ãŒå‹•ãã€èµ°ã‚ŠãªãŒã‚‰è€ƒãˆã‚‹', scores: {type5: 6} },
                    { text: 'ã¿ã‚“ãªã‚’å·»ãè¾¼ã‚“ã§ä¸€ç·’ã«é€²ã‚ã‚‹', scores: {type10: 6} },
                    { text: 'ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã‚„å‰ä¾‹ã‚’ç¢ºèªã—ã¦ã‹ã‚‰æ…é‡ã«é€²ã‚ã‚‹', scores: {type2: 6} },
                    { text: 'ç†æƒ³ã®å®Œæˆå½¢ã‚’ã‚¤ãƒ¡ãƒ¼ã‚¸ã—ã¦ã‹ã‚‰å–ã‚Šçµ„ã‚€', scores: {type6: 6} },
                    { text: 'èˆˆå‘³ãŒã‚ã‚‹ã“ã¨ã ã‘ç•°å¸¸ãªã»ã©é›†ä¸­ã™ã‚‹', scores: {type9: 6} },
                    { text: 'å‘¨ã‚Šã®ã‚„ã‚Šæ–¹ã‚’è¦³å¯Ÿã—ã¦ã‹ã‚‰åˆã‚ã›ã‚‹', scores: {type4: 6} },
                    { text: 'ã¾ãšå…¨ä½“ã®ç†è«–ã‚„ä»•çµ„ã¿ã‚’ç†è§£ã—ã¦ã‹ã‚‰å§‹ã‚ã‚‹', scores: {type1: 6, type2: 3} },
                    { text: 'ãƒ©ã‚¤ãƒãƒ«ã‚’è¦‹ã¤ã‘ã¦ç«¶äº‰ã—ãªãŒã‚‰é€²ã‚ã‚‹', scores: {type7: 6} }
                ]
            },
            {
                id: 11,
                type: 'scale',
                weight: 1.0,
                text: 'ã€Q11ã€‘ã€Œå¤§å‹¢ã®äººã¨ä¸€ç·’ã«ã„ã‚‹ã®ãŒå¥½ãã€',
                scaleOptions: [
                    { value: 5, scores: {type3: 5, type5: 4, type10: 5} },
                    { value: 4, scores: {type3: 3, type7: 2, type10: 3} },
                    { value: 3, scores: {type1: 1, type2: 1} },
                    { value: 2, scores: {type4: 2, type6: 2, type8: 1} },
                    { value: 1, scores: {type6: 4, type9: 5} }
                ]
            },
            {
                id: 12,
                type: 'single',
                weight: 1.3,
                text: 'ã€Q12ã€‘ç–²ã‚ŒãŸæ™‚ã®èº«ä½“ç—‡çŠ¶ã¯ï¼Ÿï¼ˆæœ€ã‚‚é¡•è‘—ãªã‚‚ã®ï¼‰',
                options: [
                    { text: 'èƒƒã®ä¸èª¿ã€å³è‚©ã®ã“ã‚Šã€é£Ÿæ¬²ã®å¤‰åŒ–', scores: {type3: 5} },
                    { text: 'è‚¡é–¢ç¯€ã®é•å’Œæ„Ÿã€ã‚€ãã¿ã€æœèµ·ãã‚‰ã‚Œãªã„', scores: {type8: 5} },
                    { text: 'å‘¼å¸ãŒæµ…ã„ã€ã˜ã£ã¨ã—ã¦ã„ã‚‰ã‚Œãªã„', scores: {type5: 5} },
                    { text: 'å…¨èº«ã®ã ã‚‹ã•ã€ã‚„ã‚‹æ°—ã®ä½ä¸‹', scores: {type10: 5} },
                    { text: 'é ­ç—›ã€é¦–å‘¨ã‚Šã«é•å’Œæ„Ÿã€è€ƒãˆãŒã¾ã¨ã¾ã‚‰ãªã„', scores: {type1: 5, type2: 3} },
                    { text: 'èƒ¸ã®åœ§è¿«æ„Ÿã€ç¾å®Ÿæ„Ÿã®å–ªå¤±', scores: {type6: 5} },
                    { text: 'å…¨èº«ã®ç·Šå¼µã€ä¸çœ ã€éé›†ä¸­ã®åå‹•', scores: {type9: 5} },
                    { text: 'å·¦è‚©ã®ã“ã‚Šã€æ¯è‹¦ã—ã•ã€äººç–²ã‚Œ', scores: {type4: 5} },
                    { text: 'è…°ç—›ã€æ­¯ã®é£Ÿã„ã—ã°ã‚Šã€ã‚¤ãƒ©ã‚¤ãƒ©', scores: {type7: 5} }
                ]
            },
            {
                id: 13,
                type: 'scale',
                weight: 1.2,
                text: 'ã€Q13ã€‘ã€Œãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã‚„èª¬æ˜æ›¸ã‚’èª­ã‚“ã§ã‹ã‚‰å§‹ã‚ã‚‹ã€',
                scaleOptions: [
                    { value: 5, scores: {type2: 7, type4: 2} },
                    { value: 4, scores: {type2: 4, type8: 2, type1: 1} },
                    { value: 3, scores: {type1: 1} },
                    { value: 2, scores: {type3: 2, type5: 3, type7: 2} },
                    { value: 1, scores: {type5: 5, type7: 4} }
                ]
            },
            {
                id: 14,
                type: 'single',
                weight: 1.0,
                text: 'ã€Q14ã€‘æœ€ã‚‚è½ã¡ç€ãç’°å¢ƒã¯ï¼Ÿ',
                options: [
                    { text: 'ã«ãã‚„ã‹ã§æ¥½ã—ã„ã€äººãŒé›†ã¾ã‚‹å ´æ‰€', scores: {type3: 4, type10: 2} },
                    { text: 'åœ°é“ã«ä½œæ¥­ã§ãã‚‹ã€å®Ÿç›´ãªç’°å¢ƒ', scores: {type8: 4} },
                    { text: 'æ´»æ°—ãŒã‚ã‚Šã€åˆºæ¿€çš„ãªå¤‰åŒ–ã®ã‚ã‚‹å ´æ‰€', scores: {type5: 4} },
                    { text: 'æ¸©ã‹ãåŒ…å®¹åŠ›ã®ã‚ã‚‹ã€å®¶åº­çš„ãªç©ºé–“', scores: {type10: 4} },
                    { text: 'äºˆæ¸¬å¯èƒ½ã§å®‰å…¨ãªã€æ…£ã‚Œè¦ªã—ã‚“ã å ´æ‰€', scores: {type2: 4, type4: 2} },
                    { text: 'å¹»æƒ³çš„ã§éæ—¥å¸¸çš„ãªã€ç‰¹åˆ¥ãªç©ºé–“', scores: {type6: 4} },
                    { text: 'ä¸€äººã§é›†ä¸­ã§ãã‚‹ã€é‚ªé­”ã•ã‚Œãªã„å ´æ‰€', scores: {type9: 4} },
                    { text: 'é©åº¦ãªè·é›¢æ„ŸãŒã‚ã‚‹ã€è½ã¡ç€ã„ãŸç©ºé–“', scores: {type4: 4} },
                    { text: 'é™ã‹ãªæ›¸æ–ã€å›³æ›¸é¤¨ã®ã‚ˆã†ãªçŸ¥çš„ç©ºé–“', scores: {type1: 4, type9: 2} },
                    { text: 'ç«¶äº‰ã‚„ç·Šå¼µæ„Ÿã®ã‚ã‚‹ã€å‹è² ã®å ´', scores: {type7: 4} }
                ]
            },
            {
                id: 15,
                type: 'scale',
                weight: 1.0,
                text: 'ã€Q15ã€‘ã€Œç´°ã‹ã„ã“ã¨ãŒæ°—ã«ãªã£ã¦ä»•æ–¹ãªã„ã€',
                scaleOptions: [
                    { value: 5, scores: {type2: 5, type4: 3, type9: 6} },
                    { value: 4, scores: {type1: 2, type6: 2, type8: 1} },
                    { value: 3, scores: {} },
                    { value: 2, scores: {type3: 2, type5: 2, type10: 1} },
                    { value: 1, scores: {type5: 4, type7: 3, type10: 3} }
                ]
            },
            {
                id: 16,
                type: 'single',
                weight: 1.5,
                text: 'ã€Q16ã€‘ä½•ã‹æ–°ã—ã„ã“ã¨ã‚’å§‹ã‚ã‚‹æ™‚ã®å‹•æ©Ÿã¯ï¼Ÿ',
                options: [
                    { text: 'æ¥½ã—ãã†ã§ã€ãƒ¯ã‚¯ãƒ¯ã‚¯ã™ã‚‹', scores: {type3: 6} },
                    { text: 'åœ°é“ãªåŠªåŠ›ãŒå ±ã‚ã‚Œãã†', scores: {type8: 6} },
                    { text: 'å®Ÿåˆ©ãŒã‚ã‚Šã€åŠ¹ç‡çš„ã«æˆæœãŒå‡ºã›ã‚‹', scores: {type5: 6} },
                    { text: 'ã¿ã‚“ãªã§ä¸€ç·’ã«æ¥½ã—ã‚ã‚‹', scores: {type10: 6} },
                    { text: 'å®‰å…¨æ€§ãŒç¢ºèªã§ãã€å¤±æ•—ã®ãƒªã‚¹ã‚¯ãŒä½ã„', scores: {type2: 6} },
                    { text: 'ç†æƒ³ã‚„ç¾å­¦ã«åˆè‡´ã—ã¦ã„ã‚‹', scores: {type6: 6} },
                    { text: 'å¾¹åº•çš„ã«æ¥µã‚ã‚‰ã‚Œã‚‹æ·±ã•ãŒã‚ã‚‹', scores: {type9: 6} },
                    { text: 'ä»–ã®äººã‚‚å–œã‚“ã§ãã‚Œãã†', scores: {type4: 6} },
                    { text: 'ç†è«–çš„ã«èˆˆå‘³æ·±ãã€çŸ¥çš„å¥½å¥‡å¿ƒã‚’æº€ãŸã›ã‚‹', scores: {type1: 6} },
                    { text: 'ç«¶äº‰ç›¸æ‰‹ãŒã„ã¦ã€å‹è² ã§ãã‚‹', scores: {type7: 6} }
                ]
            },
            {
                id: 17,
                type: 'scale',
                weight: 1.3,
                text: 'ã€Q17ã€‘ã€Œç«¶äº‰å¿ƒãŒå¼·ãã€è² ã‘ã‚‹ã®ãŒå«Œã„ã€',
                scaleOptions: [
                    { value: 5, scores: {type7: 8, type5: 4, type9: 2} },
                    { value: 4, scores: {type7: 5, type8: 3, type1: 1} },
                    { value: 3, scores: {type2: 1} },
                    { value: 2, scores: {type4: 2, type6: 2, type10: 2} },
                    { value: 1, scores: {type3: 2, type4: 3, type10: 3} }
                ]
            },
            {
                id: 18,
                type: 'single',
                weight: 1.5,
                text: 'ã€Q18ã€‘äººé–“é–¢ä¿‚ã§æœ€ã‚‚é‡è¦–ã™ã‚‹ã“ã¨ã¯ï¼Ÿ',
                options: [
                    { text: 'ä¸€ç·’ã«ã„ã¦æ¥½ã—ãã€æ„Ÿæƒ…ã‚’å…±æœ‰ã§ãã‚‹', scores: {type3: 6} },
                    { text: 'ä¿¡é ¼ã¨ç¾©ç†ã§çµã°ã‚ŒãŸã€å …ã„çµ†', scores: {type8: 6} },
                    { text: 'åŠ¹ç‡çš„ã§ã€ãŠäº’ã„ã«ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚‹', scores: {type5: 6} },
                    { text: 'èª°ã§ã‚‚å—ã‘å…¥ã‚Œã‚‹ã€æ¸©ã‹ã„é›°å›²æ°—', scores: {type10: 6} },
                    { text: 'å®‰å¿ƒæ„ŸãŒã‚ã‚Šã€äºˆæ¸¬å¯èƒ½ã§è£åˆ‡ã‚‰ãªã„', scores: {type2: 6} },
                    { text: 'ç†æƒ³ã‚„ç¾æ„è­˜ã‚’å…±æœ‰ã§ãã‚‹', scores: {type6: 6} },
                    { text: 'æ·±ãç†è§£ã—åˆãˆã‚‹ã€æ¿ƒå¯†ãªé–¢ä¿‚', scores: {type9: 6} },
                    { text: 'ç›¸æ‰‹ã®æ°—æŒã¡ã‚’å¯Ÿã—åˆãˆã‚‹ã€å„ªã—ã„é–¢ä¿‚', scores: {type4: 6} },
                    { text: 'çŸ¥çš„ãªè­°è«–ãŒã§ãã€è«–ç†çš„ã«é€šã˜åˆãˆã‚‹', scores: {type1: 6} },
                    { text: 'åˆ‡ç£‹ç¢ç£¨ã—ã€äº’ã„ã«é«˜ã‚åˆãˆã‚‹', scores: {type7: 6, type8: 2} }
                ]
            },
            {
                id: 19,
                type: 'scale',
                weight: 1.2,
                text: 'ã€Q19ã€‘ã€Œä¸€äººã®æ™‚é–“ãŒãªã„ã¨ã‚¹ãƒˆãƒ¬ã‚¹ã‚’æ„Ÿã˜ã‚‹ã€',
                scaleOptions: [
                    { value: 5, scores: {type6: 6, type9: 7, type4: 4} },
                    { value: 4, scores: {type1: 2, type2: 2, type8: 2} },
                    { value: 3, scores: {} },
                    { value: 2, scores: {type3: 2, type5: 2, type7: 1} },
                    { value: 1, scores: {type3: 4, type10: 5} }
                ]
            },
            {
                id: 20,
                type: 'single',
                weight: 1.5,
                text: 'ã€Q20ã€‘ã‚ãªãŸã®ç‰¹å¾´çš„ãªè¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ï¼Ÿ',
                options: [
                    { text: 'æ„Ÿæƒ…ã®èµ·ä¼ãŒæ¿€ã—ãã€æ°—åˆ†ã§è¡Œå‹•ãŒå¤‰ã‚ã‚‹', scores: {type3: 6} },
                    { text: 'æˆ‘æ…¢å¼·ãã€ä¸æº€ã‚’è¨€ã‚ãšã«è€ãˆã‚‹', scores: {type8: 6} },
                    { text: 'å³æ–­å³æ±ºã€è€ƒãˆã‚‹ã‚ˆã‚Šå…ˆã«è¡Œå‹•ã™ã‚‹', scores: {type5: 6} },
                    { text: 'èª°ã«ã§ã‚‚è¦ªåˆ‡ã§ã€ä¸–è©±å¥½ãã§åŒ…å®¹åŠ›ãŒã‚ã‚‹', scores: {type10: 6} },
                    { text: 'å¿ƒé…æ€§ã§æº–å‚™ä¸‡ç«¯ã€æœ€æ‚ªã‚’æƒ³å®šã—ã¦å‹•ã', scores: {type2: 6} },
                    { text: 'ç¾å®Ÿé›¢ã‚Œã—ãŸç†æƒ³ã‚’è¿½ã„ã€ç‹¬ç‰¹ãªä¸–ç•Œè¦³ã‚’æŒã¤', scores: {type6: 6} },
                    { text: 'ä¸€ã¤ã®ã“ã¨ã«ç•°å¸¸ã«åŸ·ç€ã—ã€å®Œç’§ã‚’æ±‚ã‚ã‚‹', scores: {type9: 6} },
                    { text: 'ç›¸æ‰‹ã«åˆã‚ã›ã€è‡ªåˆ†ã‚’æŠ‘ãˆã¦èª¿å’Œã‚’ä¿ã¤', scores: {type4: 6} },
                    { text: 'è©±ãŒç†è«–çš„ã§é•·ã„ã€è¨€è‘‰ã§å…¨ã¦èª¬æ˜ã—ãŸãŒã‚‹', scores: {type1: 6} },
                    { text: 'å‹è² ã«ã“ã ã‚ã‚Šã€å¸¸ã«èª°ã‹ã¨ç«¶ã£ã¦ã„ã‚‹', scores: {type7: 6} }
                ]
            }
        ];

        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let currentQuestion = 0;
        let answers = {};
        let scores = {
            type1: 0, type2: 0, type3: 0, type4: 0, type5: 0,
            type6: 0, type7: 0, type8: 0, type9: 0, type10: 0
        };
        let resultData = null;

        // åˆæœŸåŒ–
        function init() {
            render();
        }

        // ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
        function render() {
            const app = document.getElementById('app');
            
            if (currentQuestion < questions.length) {
                renderQuestion();
            } else {
                calculateResults();
                renderResults();
            }
        }

        // è³ªå•ç”»é¢ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
        function renderQuestion() {
            const question = questions[currentQuestion];
            const progress = ((currentQuestion + 1) / questions.length) * 100;
            
            const html = `
                <div class="header">
                    <h1>ğŸ”® ä½“ç™–è¨ºæ–­ã‚·ã‚¹ãƒ†ãƒ </h1>
                    <p class="subtitle">20ã®è³ªå•ã§ã€ã‚ãªãŸã®ä½“ç™–ã‚¿ã‚¤ãƒ—ã‚’è¨ºæ–­ã—ã¾ã™</p>
                    ${currentQuestion === 0 ? '<div style="text-align: center; margin-top: 15px;"><button class="info-btn" onclick="openTaihekiGuide()">ğŸ“š ä½“ç™–è«–ã«ã¤ã„ã¦å­¦ã¶</button></div>' : ''}
                </div>
                
                <div class="progress-container">
                    <div class="progress-bar" style="width: ${progress}%"></div>
                </div>
                
                <div class="question-number">
                    è³ªå• ${currentQuestion + 1} / ${questions.length}
                </div>
                
                <div class="question-container">
                    <h2 class="question-title">${question.text}</h2>
                    ${question.type === 'single' ? '<p style="color: #888; margin-bottom: 15px; font-size: 0.9em;">â€»æœ€å¤§2ã¤ã¾ã§é¸æŠå¯èƒ½</p>' : ''}
                    
                    ${question.type === 'single' ? renderSingleOptions(question) : renderScaleOptions(question)}
                </div>
                
                <div class="navigation">
                    <button class="btn btn-prev" onclick="previousQuestion()" ${currentQuestion === 0 ? 'disabled' : ''}>
                        æˆ»ã‚‹
                    </button>
                    <button class="btn btn-next" onclick="nextQuestion()" ${!hasAnswer(question.id) ? 'disabled' : ''}>
                        æ¬¡ã¸
                    </button>
                </div>
            `;
            
            document.getElementById('app').innerHTML = html;
        }

        // å˜ä¸€é¸æŠã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
        function renderSingleOptions(question) {
            const currentAnswers = answers[question.id] || [];
            return `
                <div class="options">
                    ${question.options.map((option, index) => `
                        <div class="option ${currentAnswers.includes(index) ? 'selected' : ''}" 
                             onclick="selectSingleAnswer(${question.id}, ${index})">
                            ${option.text}
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // ã‚¹ã‚±ãƒ¼ãƒ«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
        function renderScaleOptions(question) {
            const currentAnswer = answers[question.id];
            const labels = ['å…¨ãå½“ã¦ã¯ã¾ã‚‰ãªã„', 'ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‰ãªã„', 'ã©ã¡ã‚‰ã§ã‚‚ãªã„', 'ã‚„ã‚„å½“ã¦ã¯ã¾ã‚‹', 'ã¨ã¦ã‚‚å½“ã¦ã¯ã¾ã‚‹'];
            
            return `
                <div class="scale-options">
                    ${question.scaleOptions.map((option, index) => `
                        <div class="scale-option ${currentAnswer === index ? 'selected' : ''}" 
                             onclick="selectScaleAnswer(${question.id}, ${index})">
                            <div class="scale-label">${option.value}</div>
                            <div class="scale-text">${labels[5 - option.value]}</div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        // å˜ä¸€é¸æŠå›ç­”
        function selectSingleAnswer(questionId, answerIndex) {
            if (!answers[questionId]) {
                answers[questionId] = [];
            }
            
            const currentAnswers = answers[questionId];
            const indexPosition = currentAnswers.indexOf(answerIndex);
            
            if (indexPosition > -1) {
                currentAnswers.splice(indexPosition, 1);
            } else {
                if (currentAnswers.length < 2) {
                    currentAnswers.push(answerIndex);
                } else {
                    currentAnswers.shift();
                    currentAnswers.push(answerIndex);
                }
            }
            
            render();
        }

        // ã‚¹ã‚±ãƒ¼ãƒ«é¸æŠå›ç­”
        function selectScaleAnswer(questionId, answerIndex) {
            answers[questionId] = answerIndex;
            render();
        }

        // å›ç­”æœ‰ç„¡ãƒã‚§ãƒƒã‚¯
        function hasAnswer(questionId) {
            const answer = answers[questionId];
            if (answer === undefined) return false;
            if (Array.isArray(answer)) return answer.length > 0;
            return true;
        }

        // æ¬¡ã®è³ªå•
        function nextQuestion() {
            if (hasAnswer(questions[currentQuestion].id)) {
                currentQuestion++;
                render();
            }
        }

        // å‰ã®è³ªå•
        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                render();
            }
        }

        // çµæœè¨ˆç®—
        function calculateResults() {
            Object.keys(scores).forEach(key => scores[key] = 0);
            
            questions.forEach(question => {
                const answer = answers[question.id];
                const weight = question.weight || 1.0;
                
                if (answer !== undefined) {
                    if (question.type === 'single') {
                        const answerIndexes = answer;
                        answerIndexes.forEach(answerIndex => {
                            const answerScores = question.options[answerIndex].scores;
                            Object.entries(answerScores).forEach(([type, score]) => {
                                const adjustedScore = answerIndexes.length > 1 ? 
                                    Math.floor(score * weight * 0.8) : 
                                    Math.floor(score * weight);
                                scores[type] += adjustedScore;
                            });
                        });
                    } else {
                        const answerScores = question.scaleOptions[answer].scores;
                        Object.entries(answerScores).forEach(([type, score]) => {
                            scores[type] += Math.floor(score * weight);
                        });
                    }
                }
            });
        }

        // çµæœç”»é¢ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
        function renderResults() {
            const sortedScores = Object.entries(scores).sort(([,a], [,b]) => b - a);
            
            const primaryType = sortedScores[0][0];
            const primaryScore = sortedScores[0][1];
            const secondaryType = sortedScores[1][0];
            const secondaryScore = sortedScores[1][1];
            const maxScore = Math.max(...Object.values(scores));
            
            // ä¿¡é ¼åº¦è¨ˆç®—ï¼ˆæ¯”ç‡ï¼‰
            const reliabilityRatio = primaryScore / (secondaryScore || 1);

            // ä¿¡é ¼åº¦ã‚’0-1ã®ç¯„å›²ã«æ­£è¦åŒ–ï¼ˆæ¯”ç‡1.0ã‚’0.5ã€1.5ä»¥ä¸Šã‚’1.0ã«ãƒãƒƒãƒ”ãƒ³ã‚°ï¼‰
            const reliabilityValue = Math.min(1.0, Math.max(0, (reliabilityRatio - 1.0) / 0.5));

            let reliabilityText = '';
            let reliabilityStarsDisplay = '';
            let reliabilityStarsNumeric = 0;

            if (reliabilityRatio >= 1.5) {
                reliabilityText = 'éå¸¸ã«é«˜ã„';
                reliabilityStarsDisplay = 'â˜…â˜…â˜…â˜…â˜…';
                reliabilityStarsNumeric = 5;
            } else if (reliabilityRatio >= 1.3) {
                reliabilityText = 'é«˜ã„';
                reliabilityStarsDisplay = 'â˜…â˜…â˜…â˜…â˜†';
                reliabilityStarsNumeric = 4;
            } else if (reliabilityRatio >= 1.15) {
                reliabilityText = 'ä¸­ç¨‹åº¦';
                reliabilityStarsDisplay = 'â˜…â˜…â˜…â˜†â˜†';
                reliabilityStarsNumeric = 3;
            } else {
                reliabilityText = 'å‚è€ƒç¨‹åº¦';
                reliabilityStarsDisplay = 'â˜…â˜…â˜†â˜†â˜†';
                reliabilityStarsNumeric = 2;
            }

            resultData = {
                primaryType,
                primaryScore,
                secondaryType,
                secondaryScore,
                reliabilityRatio, // è¡¨ç¤ºç”¨ã®æ¯”ç‡
                reliabilityValue, // 0-1ã®æ­£è¦åŒ–ã•ã‚ŒãŸå€¤
                reliabilityText,
                reliabilityStarsDisplay, // è¡¨ç¤ºç”¨ã®æ˜Ÿè¨˜å·
                reliabilityStarsNumeric, // ä¿å­˜ç”¨ã®æ•°å€¤ï¼ˆ1-5ï¼‰
                sortedScores,
                maxScore
            };
            
            const html = `
                <div class="results">
                    <div class="result-header">
                        <div style="text-align: center; margin-bottom: 15px;">
                            <button class="info-btn" onclick="openTaihekiGuide()">ğŸ“š ä½“ç™–è«–ã«ã¤ã„ã¦å­¦ã¶</button>
                        </div>
                        <h1 class="result-title">ğŸ‰ è¨ºæ–­çµæœ</h1>
                    </div>
                    
                    <div class="main-result">
                        <h2 style="color: #666; margin-bottom: 20px;">ã‚ãªãŸã®ä¸»ä½“ç™–ã¯...</h2>
                        <div class="type-name">${taihekiTypes[primaryType].name}</div>
                        <div style="color: #888; margin-bottom: 15px;">${taihekiTypes[primaryType].subtitle}</div>
                        <div class="type-description">${taihekiTypes[primaryType].description}</div>
                        
                        <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #e0e0e0;">
                            <h3 style="color: #666; margin-bottom: 10px;">å‰¯ä½“ç™–</h3>
                            <div style="color: #667eea; font-weight: bold; font-size: 1.2em;">${taihekiTypes[secondaryType].name}</div>
                            <div style="color: #888; font-size: 0.9em;">${taihekiTypes[secondaryType].subtitle}</div>
                        </div>
                        
                        <div style="margin-top: 20px; padding: 15px; background: #f8f9ff; border-radius: 10px;">
                            <h4 style="color: #667eea; margin-bottom: 8px;">è¨ºæ–­ã®ä¿¡é ¼åº¦</h4>
                            <div style="font-size: 1.2em; color: #FFD700;">${reliabilityStarsDisplay}</div>
                            <div style="color: #666; font-size: 0.9em; margin-top: 5px;">
                                ä¿¡é ¼åº¦: ${reliabilityText}
                                (ä¸»ä½“ç™– ${primaryScore}pt / å‰¯ä½“ç™– ${secondaryScore}pt = ${reliabilityRatio.toFixed(2)})
                            </div>
                        </div>
                    </div>
                    
                    <div class="score-chart">
                        <h3 style="text-align: center; margin-bottom: 20px; color: #666;">å„ä½“ç™–ã‚¹ã‚³ã‚¢è©³ç´°</h3>
                        ${sortedScores.map(([type, score]) => `
                            <div class="score-item">
                                <div class="score-label">${taihekiTypes[type].name.replace('ä½“ç™–', '')}</div>
                                <div class="score-bar-container">
                                    <div class="score-bar" style="width: ${(score / maxScore) * 100}%">
                                        <span class="score-value">${score}pt</span>
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                    
                    <div class="action-buttons">
                        <button class="restart-btn" onclick="restart()">
                            ã‚‚ã†ä¸€åº¦è¨ºæ–­ã™ã‚‹
                        </button>
                        <button class="download-btn" onclick="downloadResult()">
                            ç”»åƒã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
                        </button>
                        <button class="save-result-btn" onclick="saveAndContinue()" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 15px 30px; font-size: 1.1em; border-radius: 12px; cursor: pointer; margin-top: 10px; width: 100%; font-weight: 600;">
                            è¨ºæ–­çµæœã‚’ä¿å­˜ã—ã¦ç¶šã‘ã‚‹ â†’
                        </button>
                    </div>
                </div>
            `;

            document.getElementById('app').innerHTML = html;

            // è¨ºæ–­çµæœã‚’localStorageã«è‡ªå‹•ä¿å­˜
            saveDiagnosisResult();
            
            setTimeout(() => {
                document.querySelectorAll('.score-bar').forEach((bar, index) => {
                    setTimeout(() => {
                        bar.style.width = bar.style.width;
                    }, index * 100);
                });
            }, 100);
        }

        // çµæœç”»åƒç”Ÿæˆ
        function generateResultImage() {
            const canvas = document.getElementById('result-canvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = 800;
            canvas.height = 1000;
            
            // èƒŒæ™¯ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            gradient.addColorStop(0, '#667eea');
            gradient.addColorStop(1, '#764ba2');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // ç™½ã„èƒŒæ™¯ï¼ˆè§’ä¸¸é¢¨ï¼‰
            ctx.fillStyle = 'white';
            ctx.fillRect(40, 40, canvas.width - 80, canvas.height - 80);
            
            // ã‚¿ã‚¤ãƒˆãƒ«
            ctx.fillStyle = '#333';
            ctx.font = 'bold 36px Arial, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('ä½“ç™–è¨ºæ–­çµæœ', canvas.width / 2, 120);
            
            if (resultData) {
                // ä¸»ä½“ç™–ãƒ©ãƒ™ãƒ«
                ctx.font = 'bold 28px Arial, sans-serif';
                ctx.fillStyle = '#667eea';
                ctx.fillText('ã‚ãªãŸã®ä¸»ä½“ç™–ã¯...', canvas.width / 2, 200);
                
                // ä¸»ä½“ç™–å
                ctx.font = 'bold 42px Arial, sans-serif';
                ctx.fillStyle = '#667eea';
                ctx.fillText(taihekiTypes[resultData.primaryType].name, canvas.width / 2, 260);
                
                // ã‚µãƒ–ã‚¿ã‚¤ãƒˆãƒ«
                ctx.font = '24px Arial, sans-serif';
                ctx.fillStyle = '#888';
                ctx.fillText(taihekiTypes[resultData.primaryType].subtitle, canvas.width / 2, 300);
                
                // èª¬æ˜æ–‡
                ctx.font = '20px Arial, sans-serif';
                ctx.fillStyle = '#333';
                const description = taihekiTypes[resultData.primaryType].description;
                
                // æ–‡å­—åˆ—ã‚’è¤‡æ•°è¡Œã«åˆ†å‰²
                const maxWidth = canvas.width - 120;
                const lines = wrapText(ctx, description, maxWidth);
                let currentY = 350;
                lines.forEach(line => {
                    ctx.fillText(line, canvas.width / 2, currentY);
                    currentY += 30;
                });
                
                // å‰¯ä½“ç™–
                currentY += 20;
                ctx.font = 'bold 24px Arial, sans-serif';
                ctx.fillStyle = '#666';
                ctx.fillText('å‰¯ä½“ç™–', canvas.width / 2, currentY);
                
                currentY += 40;
                ctx.font = 'bold 32px Arial, sans-serif';
                ctx.fillStyle = '#667eea';
                ctx.fillText(taihekiTypes[resultData.secondaryType].name, canvas.width / 2, currentY);
                
                // ä¿¡é ¼åº¦
                currentY += 70;
                ctx.font = '24px Arial, sans-serif';
                ctx.fillStyle = '#666';
                ctx.fillText('è¨ºæ–­ã®ä¿¡é ¼åº¦', canvas.width / 2, currentY);
                
                currentY += 40;
                ctx.font = '32px Arial, sans-serif';
                ctx.fillStyle = '#FFD700';
                ctx.fillText(resultData.reliabilityStarsDisplay, canvas.width / 2, currentY);

                currentY += 30;
                ctx.font = '18px Arial, sans-serif';
                ctx.fillStyle = '#666';
                ctx.fillText(`ä¿¡é ¼åº¦: ${resultData.reliabilityText}`, canvas.width / 2, currentY);
                
                // ã‚¹ã‚³ã‚¢ãƒãƒ£ãƒ¼ãƒˆï¼ˆä¸Šä½5ã¤ï¼‰
                currentY += 60;
                ctx.font = 'bold 24px Arial, sans-serif';
                ctx.fillStyle = '#666';
                ctx.fillText('ä¸»è¦ã‚¹ã‚³ã‚¢', canvas.width / 2, currentY);
                
                const topScores = resultData.sortedScores.slice(0, 5);
                currentY += 40;
                
                topScores.forEach(([type, score], index) => {
                    const y = currentY + index * 40;
                    const barWidth = (score / resultData.maxScore) * 300;
                    
                    // ãƒ©ãƒ™ãƒ«
                    ctx.font = '16px Arial, sans-serif';
                    ctx.fillStyle = '#333';
                    ctx.textAlign = 'left';
                    ctx.fillText(taihekiTypes[type].name.replace('ä½“ç™–', ''), 80, y + 5);
                    
                    // ãƒãƒ¼èƒŒæ™¯
                    ctx.fillStyle = '#f0f0f0';
                    ctx.fillRect(180, y - 12, 300, 20);
                    
                    // ãƒãƒ¼
                    if (barWidth > 0) {
                        const barGradient = ctx.createLinearGradient(180, y, 180 + barWidth, y);
                        barGradient.addColorStop(0, '#667eea');
                        barGradient.addColorStop(1, '#764ba2');
                        ctx.fillStyle = barGradient;
                        ctx.fillRect(180, y - 12, barWidth, 20);
                    }
                    
                    // ã‚¹ã‚³ã‚¢
                    ctx.font = 'bold 14px Arial, sans-serif';
                    ctx.fillStyle = '#333';
                    ctx.textAlign = 'right';
                    ctx.fillText(`${score}pt`, 490, y + 3);
                });
                
                // ãƒ•ãƒƒã‚¿ãƒ¼
                ctx.font = '16px Arial, sans-serif';
                ctx.fillStyle = '#888';
                ctx.textAlign = 'center';
                ctx.fillText('ä½“ç™–è¨ºæ–­ã‚·ã‚¹ãƒ†ãƒ ', canvas.width / 2, canvas.height - 60);
            }
            
            return canvas.toDataURL('image/png');
        }
        
        // ãƒ†ã‚­ã‚¹ãƒˆæŠ˜ã‚Šè¿”ã—é–¢æ•°
        function wrapText(ctx, text, maxWidth) {
            const words = text.split('');
            const lines = [];
            let currentLine = '';
            
            for (let i = 0; i < words.length; i++) {
                const testLine = currentLine + words[i];
                const metrics = ctx.measureText(testLine);
                
                if (metrics.width > maxWidth && currentLine !== '') {
                    lines.push(currentLine);
                    currentLine = words[i];
                } else {
                    currentLine = testLine;
                }
            }
            
            if (currentLine) {
                lines.push(currentLine);
            }
            
            return lines;
        }

        // ç”»åƒãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
        function downloadResult() {
            try {
                const imageData = generateResultImage();
                const link = document.createElement('a');
                link.download = `ä½“ç™–è¨ºæ–­çµæœ_${taihekiTypes[resultData.primaryType].name}.png`;
                link.href = imageData;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            } catch (error) {
                console.error('ç”»åƒç”Ÿæˆã‚¨ãƒ©ãƒ¼:', error);
                alert('ç”»åƒã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚');
            }
        }

        // ä½“ç™–è«–è§£èª¬ã‚µã‚¤ãƒˆã‚’é–‹ã
        function openTaihekiGuide() {
            window.open('https://claude.ai/public/artifacts/635b3100-76bb-4f94-9b58-c24d7742076e', '_blank');
        }

        // è¨ºæ–­çµæœã‚’localStorageã«ä¿å­˜
        function saveDiagnosisResult() {
            if (!resultData) return;

            const diagnosisResult = {
                type: 'taiheki',
                version: '1.0.0', // ã‚¹ã‚­ãƒ¼ãƒãƒãƒ¼ã‚¸ãƒ§ãƒ³
                timestamp: new Date().toISOString(),
                primary: {
                    type: resultData.primaryType,
                    name: taihekiTypes[resultData.primaryType].name,
                    subtitle: taihekiTypes[resultData.primaryType].subtitle,
                    description: taihekiTypes[resultData.primaryType].description,
                    score: resultData.primaryScore
                },
                secondary: {
                    type: resultData.secondaryType,
                    name: taihekiTypes[resultData.secondaryType].name,
                    subtitle: taihekiTypes[resultData.secondaryType].subtitle,
                    score: resultData.secondaryScore
                },
                reliability: {
                    value: resultData.reliabilityValue, // 0-1ã®æ­£è¦åŒ–ã•ã‚ŒãŸå€¤
                    text: resultData.reliabilityText,
                    stars: resultData.reliabilityStarsNumeric // 1-5ã®æ•°å€¤
                },
                allScores: resultData.sortedScores.reduce((acc, [type, score]) => {
                    acc[type] = score;
                    return acc;
                }, {})
            };

            // localStorageã«ä¿å­˜ï¼ˆæ—¢å­˜ã®Zustandè¨ºæ–­ãƒ‡ãƒ¼ã‚¿ã¨çµ±åˆï¼‰
            try {
                localStorage.setItem('taiheki_diagnosis_result', JSON.stringify(diagnosisResult));
                console.log('è¨ºæ–­çµæœã‚’ä¿å­˜ã—ã¾ã—ãŸ:', diagnosisResult);
            } catch (error) {
                console.error('è¨ºæ–­çµæœã®ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
            }
        }

        // è¨ºæ–­çµæœã‚’ä¿å­˜ã—ã¦Next.jsã®è¨ºæ–­ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
        function saveAndContinue() {
            saveDiagnosisResult();
            // Next.jsã®è¨ºæ–­çµæœãƒšãƒ¼ã‚¸ã«é·ç§»
            window.location.href = '/diagnosis/results';
        }

        // å†é–‹å§‹
        function restart() {
            currentQuestion = 0;
            answers = {};
            scores = {
                type1: 0, type2: 0, type3: 0, type4: 0, type5: 0,
                type6: 0, type7: 0, type8: 0, type9: 0, type10: 0
            };
            resultData = null;
            render();
        }

        // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹
        init();
    </script>
</body>
</html>