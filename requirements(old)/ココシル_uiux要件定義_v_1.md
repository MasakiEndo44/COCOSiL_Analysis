# ココシル UI/UX 要件定義（詳細版）

本書は、性格分析アプリ「ココシル」の**デザインガイド & 実装基準**です。Figma/コード/品質保証の共通言語として使用します。

---

## 0. デザイン原則（Design Principles）
- **多面的な自己理解**：5占術×AIという複合性を、UIでは「わかりやすさ」と「深さ」の両立で表現。
- **行動に落ちる導線**：診断結果→アクションの距離を最短化（1～2タップ）。
- **安心・やわらかさ**：パステル×グラデの世界観。否定語より提案語。
- **一貫したスケール**：8pxグリッド、タイプスケール、トークン管理。
- **アクセシビリティ優先**：WCAG 2.2 AA準拠を最低基準。

---

## 1. カラースキーム（Brand & UI Colors）
> ブランドは“薄明のグラデーション”：**#3EB1D4 → #C062F5** を核とする。可読性確保のため、UIはニュートラル系を多用し、アクセントを最小限で効かせる。

### 1.1 ブランド / アクセント
| Token | Hex | 用途 |
|---|---|---|
| `--brand-500` | **#7AC5E5** | ロゴ/ハイライト（明部） |
| `--brand-700` | **#4A9FD0** | 強調ボタン境界/リンクホバー |
| `--accent-500` | **#C062F5** | 重要CTA/プログレス先頭色 |
| `--accent-600` | **#A54EE6** | Hover/Active |
| `--accent-700` | **#8E3FDA** | ダーク面強調 |

### 1.2 グラデーション（ブランド）
- `--gradient-brand`: **linear(135deg, #3EB1D4 0%, #C062F5 100%)**
- `--gradient-brand-soft`: **linear(135deg, #3EB1D480 0%, #C062F580 100%)**（背景用 50%透明）

### 1.3 役割別 UI カラー（ライトモード）
| Role | Token | Hex |
|---|---|---|
| 背景（面） | `--bg` | **#FFFFFF** |
| 背景（サブ） | `--bg-subtle` | **#F7F8FA** |
| 枠線 | `--border` | **#E5E7EB** |
| テキスト（主） | `--fg` | **#101828** |
| テキスト（次） | `--fg-muted` | **#475467** |
| プライマリ | `--primary` | **#7A5AF8** |
| プライマリ対向 | `--on-primary` | **#FFFFFF** |
| 成功 | `--success` | **#16A34A** |
| 警告 | `--warning` | **#F59E0B** |
| エラー | `--error` | **#EF4444** |
| 情報 | `--info` | **#0EA5E9** |

> **コントラスト目安（AA）**：主文テキストは**4.5:1以上**。ボタン文字と背景は**4.5:1以上**。薄色上の小サイズ文字は禁止。

### 1.4 ダークモード
| Role | Token | Hex |
|---|---|---|
| 背景（面） | `--bg` | **#0B0F1A** |
| 背景（サブ） | `--bg-subtle` | **#121826** |
| 枠線 | `--border` | **#233046** |
| テキスト（主） | `--fg` | **#E6E8EE** |
| テキスト（次） | `--fg-muted` | **#9AA4B2** |
| プライマリ | `--primary` | **#9C8CFF** |
| プライマリ対向 | `--on-primary` | **#0B0F1A** |
| 成功/警告/エラー | 同系で**+20%明度** |

### 1.5 ステートレイヤー（共通）
| 状態 | 透明度 |
|---|---|
| Hover | 8% レイヤー追加 |
| Focus | 2px 外側グロー（ブランド700 40%） |
| Pressed | 12% レイヤー追加 |
| Disabled | 彩度-50%、不透明度 38% |

---

## 2. タイポグラフィ（Japanese-first）
- **本文**：*Noto Sans JP*, *system-ui*（可読性重視）
- **見出し**：*Poppins*（幾何学×やわらか）
- **等幅**：*JetBrains Mono*

### 2.1 スケール（モバイル / デスクトップ）
| Role | Mobile | Desktop |
|---|---|---|
| H1 | 28/36 | 40/48 |
| H2 | 24/32 | 32/40 |
| H3 | 20/28 | 24/32 |
| Body L | 16/24 | 18/28 |
| Body M | 14/22 | 16/24 |
| Caption | 12/18 | 12/18 |

- 字間：日本語は 0～0.02em、英字は +0.02～0.04em。
- 見出しは**最大2行**、それ以上は折り返し。

---

## 3. スペーシング & レイアウト
- **8px グリッド**（ベース 4px も許容）
- スペース：`4, 8, 12, 16, 20, 24, 32, 40, 48, 64`
- 角丸：`8`（カード/入力）、`12`（モーダル）、`24`（ヒーローカード）
- 影：Z1(0,1,2,0/10%) / Z2(0,6,12,0/12%) / Z3(0,12,24,0/16%)

### 3.1 ブレークポイント
| Label | px |
|---|---|
| XS | ≤ 399 |
| SM | 400–767 |
| MD | 768–1023 |
| LG | 1024–1439 |
| XL | ≥ 1440 |

- **モバイルナビ**：ボトムタブ（最大5）。
- **Web**：左サイド + トップバー。

---

## 4. コンポーネント規格（要点）
### 4.1 ボタン
- 種別：Primary / Secondary / Tertiary / Destructive
- 高さ：`40`（モバイル）、`44`（Web）
- アイコン左 16px、ラベル左右 12–16px
- ローディングは**スピナー置換**、ラベル保持

### 4.2 フォーム
- 入力高さ `44`、内側余白 `12`、角丸 `8`
- ラベル上、補助文下、エラーテキスト赤（`--error`）
- バリデーション：ライブ + フォーカスアウト

### 4.3 カード/セクション
- 内側余白 `16`、角丸 `12`、影 Z1
- セクション見出しに**小バッジ**で占術タグ

### 4.4 ナビゲーション
- **Tab**：ラベル必須、アイコン任意
- **Stepper**：診断 3 ステップ可視化

### 4.5 フィードバック
- **Toast**：右下（Web）/ 下部中央（App） 3s
- **Empty**：ブランドソフトグラデ背景 + 行動提案 CTA

---

## 5. アクセシビリティ（WCAG 2.2 AA）
- コントラスト：本文/ボタン 4.5:1 以上。
- フォーカス可視：キーボード Tab 移動は**2px グロー**必須。
- タップ領域：最小 **44×44**。
- 動きの軽減：OS設定を尊重（アニメを 50% 減速/非表示）。
- 代替テキスト：チャート/イラストに必須。

---

## 6. モーション（Motion）
- デュレーション：150ms（小）/ 240ms（中）/ 320ms（大）
- イージング：`cubic-bezier(0.2, 0.0, 0.2, 1)`（標準）
- 意味付け：
  - **診断進捗**：アクセントグラデの**左右ワイプ**
  - **結果表示**：カードの**フェード+上方向 8px**
  - **成功**：チェック 200ms スケールイン

---

## 7. コンテンツ設計（Voice & Microcopy）
- トーン：**共感 > 提案 > 行動**。
- 禁止：断定的な占断、恐怖訴求。
- CTA文例：
  - 「今日からできる1歩を確認する」
  - 「仕事・恋愛どちらを先に整える？」

---

## 8. 情報設計（IA）
- メインタブ：**ホーム / 診断 / レポート / 相性 / 設定**
- レポート内：**強み / リスク / アクション / 推移ログ**
- 2タップ以内で**行動案**へ。

---

## 9. ダークモード方針
- 背景は**純黒回避**（#0B0F1A）。
- グラデは**彩度-10%、明度+10%**で調整。
- 陰影は**内側シャドウ**で視認性補助。

---

## 10. データ可視化（ミニチャート）
- 枠：`--border`、目盛りは 50% 透明。
- プライマリ系列：`--primary`
- 比較系列：`--accent-600`
- カラーは最大 **5 系列**。色弱配慮（赤緑回避）。

---

## 11. イラスト/アイコン指針
- アイコン：**Lucide/Feather系**のアウトライン 1.5–2.0px。
- イラスト：**ソフトグラデ + 低彩度パステル**。
- 使用箇所：ヒーロー、空状態、オンボーディング。

---

## 12. 主要スクリーンの期待挙動（抜粋）
1) **診断（Step 1/2/3）**
- 進捗 0–100%、中断リカバリ。
- 質問は 1 画面 1 問、スワイプ可。

2) **結果ダッシュボード**
- 上段：総合インサイト（3行以内）。
- 下段：**今日のアクション**（最大3）。
- 共有：テキストのみ / 画像カード（個人情報抜き）。

3) **相性**
- 共有リンクで**簡易相性**をプレビュー。

4) **認証選択画面（Phase 1実装）**
- **レイアウト**: 縦3ボタン中央配置、最大幅480px
- **第1ボタン（アカウント作成）**:
  - カラー: `--accent-500` 背景、白テキスト
  - アイコン: 🔐 左寄せ、24px
  - メインラベル: 「アカウントを作成して始める」（16px/Bold）
  - サブラベル: 「→ 診断結果を保存・履歴閲覧可能」（12px/Regular、opacity 90%）
  - hover: `--accent-600`、active: `--accent-700`
- **第2ボタン（サインイン）**:
  - カラー: `--fg` 背景、白テキスト
  - アイコン: ✅ 左寄せ、24px
  - メインラベル: 「サインインして始める」（16px/Bold）
  - サブラベル: 「→ 既存アカウントで続ける」（12px/Regular、opacity 90%）
  - hover: `--fg-muted`
- **第3ボタン（匿名）**:
  - カラー: `--bg-subtle` 背景、2px `--border` 枠線、`--fg` テキスト
  - アイコン: 👤 左寄せ、24px
  - メインラベル: 「匿名で続ける」（16px/Bold）
  - サブラベル: 「→ 30日間ブラウザに保存」（12px/Regular、`--fg-muted`）
  - hover: `--bg` + 8%グレー重ね
- **スペーシング**: ボタン間16px、ボタン内padding 16px
- **アニメーション**: フェードイン（400ms ease-out）、ボタントランジション 150ms
- **アクセシビリティ**:
  - 各ボタンにaria-label
  - キーボードナビゲーション対応（Tab/Enter）
  - コントラスト比 4.5:1以上

5) **Clerkサインイン/サインアップ画面**
- **基本方針**: Clerk提供UIを使用（カスタマイズ最小限）
- **ローカライゼーション**: `jaJP` 適用
- **ブランド統合**:
  - プライマリカラー: `--accent-500`
  - 背景: `--bg`
  - 枠線: `--border`
- **レイアウト**: Clerk標準レイアウト維持
- **リダイレクト**:
  - サインイン後: `/diagnosis`
  - サインアップ後: `/diagnosis`
  - キャンセル: `/` (ランディング)

6) **診断履歴画面（Phase 2実装）**
- **ヘッダー**: 「診断履歴」（H2、中央揃え）
- **リストアイテム**:
  - カード形式、8px角丸、`--z1`シャドウ
  - 上段: 診断日時（14px/Regular、`--fg-muted`）
  - 中段: 診断結果サマリー（16px/Bold、`--fg`）
    - 例: 「MBTI: INTJ, 体癖: 2種」
  - 下段: 「詳細を見る」リンク（14px/Medium、`--accent-500`）
- **スペーシング**: カード間16px、カード内padding 16px
- **空状態**:
  - アイコン: 📋（48px、`--fg-muted`）
  - テキスト: 「まだ診断履歴がありません」（16px/Regular、`--fg-muted`）
  - CTA: 「診断を始める」ボタン（`--accent-500`）
- **ページネーション**: 10件/ページ、「もっと見る」ボタン
- **アニメーション**: カードホバーで`--z2`シャドウへ変化（200ms）

7) **AIチャット履歴画面（Phase 3実装）**
- **ヘッダー**: 「対話履歴」（H2、中央揃え）
- **リストアイテム**:
  - カード形式、8px角丸、`--z1`シャドウ
  - 上段: 対話開始日時（14px/Regular、`--fg-muted`） + トピックバッジ（12px/Medium、`--accent-500`背景、白テキスト）
  - 中段: 対話の最初のメッセージ（14px/Regular、`--fg`、最大2行、省略記号）
  - 下段: 「対話を続ける」リンク（14px/Medium、`--accent-500`）
- **トピックバッジ**: 人間関係/キャリア/性格理解/将来
- **スペーシング**: カード間16px、カード内padding 16px
- **空状態**: 診断履歴画面と同様のパターン
- **削除アクション**:
  - スワイプジェスチャー（モバイル）
  - 「…」メニュー → 「削除」（デスクトップ）
  - 確認ダイアログ: 「この対話を削除しますか？」
- **認証状態インジケーター**:
  - 認証ユーザー: 「対話は保存されています」（緑チェックアイコン、12px）
  - 匿名ユーザー: 「対話は30日後に消えます」（黄警告アイコン、12px）

8) **認証状態表示（共通コンポーネント）**
- **ヘッダー右上**:
  - 認証ユーザー: Clerkユーザーボタン（アバター + 名前）
  - 匿名ユーザー: 「サインイン」リンク（14px/Medium、`--accent-500`）
- **診断画面内CTA（匿名ユーザーのみ）**:
  - バナー形式、`--info`背景（20%透明度）、`--border`枠線
  - テキスト: 「サインインして診断を保存しましょう」（14px/Medium、`--fg`）
  - ボタン: 「サインイン」（`--accent-500`）
  - 位置: 診断完了画面の最下部
- **AIチャット画面内CTA（匿名ユーザーのみ）**:
  - 同様のバナー形式
  - テキスト: 「サインインして対話を保存しましょう」

---

## 13. デザイントークン（例：CSS Variables）
```css
:root{
  /* Brand */
  --brand-500:#7AC5E5; --brand-700:#4A9FD0;
  --accent-500:#C062F5; --accent-600:#A54EE6; --accent-700:#8E3FDA;
  --gradient-brand: linear-gradient(135deg,#3EB1D4 0%,#C062F5 100%);

  /* Light */
  --bg:#FFFFFF; --bg-subtle:#F7F8FA; --border:#E5E7EB;
  --fg:#101828; --fg-muted:#475467;
  --primary:#7A5AF8; --on-primary:#FFFFFF;
  --success:#16A34A; --warning:#F59E0B; --error:#EF4444; --info:#0EA5E9;

  /* Radius & Shadow */
  --r-8:8px; --r-12:12px; --r-24:24px;
  --z1:0 1px 2px rgba(16,24,40,.10);
  --z2:0 6px 12px rgba(16,24,40,.12);
  --z3:0 12px 24px rgba(16,24,40,.16);
}
@media(prefers-color-scheme:dark){
  :root{
    --bg:#0B0F1A; --bg-subtle:#121826; --border:#233046;
    --fg:#E6E8EE; --fg-muted:#9AA4B2; --primary:#9C8CFF; --on-primary:#0B0F1A;
  }
}
```

---

## 14. 品質チェックリスト（抜粋）
- [ ] 主要CTAは視線導線の**右手親指**位置（モバイル）。
- [ ] 文章ブロックは**40–70文字/行**。
- [ ] 連続入力は**オートスクロール**でラベルを常に可視。
- [ ] すべての画像に**alt**。チャートは**サマリー文**付与。
- [ ] 色に依存しない**形状/テキスト**によるステータス表現。

---

## 15. ハンドオフ規約（Figma）
- スタイル：**Color/Type/Effect/Grid**に登録必須。
- コンポーネント命名：`cmp.Button/Primary/L`。
- アイコン24px基準、余白は**2px刻み**。
- エクスポート：SVG（アイコン）/ PNG@2x（イラスト）。

---

## 16. 今後の拡張（テーマ対応）
- 季節テーマ：**春（桜ピンク）/ 夏（ミント）/ 秋（琥珀）/ 冬（紺碧）** を**トークン差し替え**で実現。
- 有償プランで**プレミアム配色**（金箔ライクのリニアグラデ）。

---

### 付録A：エンプティ/エラー文テンプレ
- エンプティ：
  - 見出し「あなたの“らしさ”を集めています」
  - 説明「今日の質問に答えると、精度が上がります。」
  - CTA「質問に答える」
- エラー：
  - 見出し「接続できませんでした」
  - 説明「通信環境を確認して、もう一度お試しください。」
  - CTA「再試行」

---

**以上**（v1.0）。

